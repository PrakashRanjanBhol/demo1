// MODIFIED approveAndContinue
public async approveAndContinue(): Promise<void> {
  if (this.currentApprovalRequest && !this.isApprovingChanges) {
    console.log('✅ APPROVED:', this.currentApprovalRequest.data);
    console.log('Saving code changes via API...\n');
    
    this.isApprovingChanges = true;
    this.cdr.detectChanges();
    
    try {
      const fileDetails = this.getFileDetails(this.currentApprovalRequest.data.content);
      
      if (fileDetails) {
        const payload = {
          tool: this.currentApprovalRequest.data.tool,
          file_path: fileDetails.file_path,
          file_name: fileDetails.file_name,
          original_code: fileDetails.original_code || '',
          modified_code: fileDetails.modified_code || '',
          reasoning: this.getReasoning(this.currentApprovalRequest.data.content),
          timestamp: new Date().toISOString()
        };
        
        await this.saveCodeChanges(payload);
        console.log('✅ Code changes saved successfully');
      }
      
      // MODIFIED: Animate transition
      this.showApprovalCard = false;
      this.cdr.detectChanges();
      
      // Append accepted file to DOM
      setTimeout(() => {
        this.appendAcceptedFile(this.currentApprovalRequest!.data, false); // false = not rejected
        
        this.isWaitingForApproval = false;
        this.currentApprovalRequest = null;
        this.showStreamingContainer = true;
        
        this.parserService.approveAndContinue();
        this.updateLists();
        this.scrollToBottom();
        this.cdr.detectChanges();
      }, 400);
      
    } catch (error) {
      console.error('❌ Failed to save code changes:', error);
      alert('Failed to save code changes. Please try again.');
      this.isApprovingChanges = false;
      this.cdr.detectChanges();
      return;
    }
    
    setTimeout(() => {
      this.isApprovingChanges = false;
      this.cdr.detectChanges();
    }, 500);
  }
}

// MODIFIED rejectChanges
public rejectChanges(): void {
  if (this.currentApprovalRequest) {
    console.log('❌ REJECTED:', this.currentApprovalRequest.data);
    console.log('Continuing with next operation...\n');
    
    this.currentApprovalRequest.data.rejected = true;
    this.executedItems.push(this.currentApprovalRequest.data);
    
    // MODIFIED: Animate transition
    this.showApprovalCard = false;
    this.cdr.detectChanges();
    
    // Append rejected file to DOM
    setTimeout(() => {
      this.appendAcceptedFile(this.currentApprovalRequest!.data, true); // true = rejected
      
      this.isWaitingForApproval = false;
      this.currentApprovalRequest = null;
      this.showStreamingContainer = true;
      
      this.parserService.approveAndContinue();
      this.updateLists();
      this.scrollToBottom();
      this.cdr.detectChanges();
    }, 400);
  }
}

// NEW METHOD: Append accepted/rejected file as DOM element
private appendAcceptedFile(toolData: ToolData, isRejected: boolean): void {
  const streamingContainer = document.getElementById('vibe-coding-streaming-container');
  
  if (!streamingContainer) {
    console.warn('Streaming container not found');
    return;
  }

  const fileDetails = this.getFileDetails(toolData.content);
  if (!fileDetails || !fileDetails.file_name) {
    console.warn('No file details found');
    return;
  }

  // Create the file item element
  const fileItemDiv = document.createElement('div');
  fileItemDiv.className = 'vibe-coding-file-item vibe-coding-new';
  
  // Create file icon
  const iconDiv = document.createElement('div');
  iconDiv.className = 'vibe-coding-file-icon';
  iconDiv.textContent = this.getFileExtension(fileDetails.file_name);
  
  // Create file info container
  const infoDiv = document.createElement('div');
  infoDiv.className = 'vibe-coding-file-info';
  
  // Create file name
  const nameDiv = document.createElement('div');
  nameDiv.className = 'vibe-coding-file-name';
  nameDiv.textContent = fileDetails.file_name;
  
  // Create file path (if exists)
  if (fileDetails.file_path) {
    const pathDiv = document.createElement('div');
    pathDiv.className = 'vibe-coding-file-path';
    pathDiv.textContent = fileDetails.file_path;
    infoDiv.appendChild(nameDiv);
    infoDiv.appendChild(pathDiv);
  } else {
    infoDiv.appendChild(nameDiv);
  }
  
  // Create time badge
  const timeDiv = document.createElement('div');
  timeDiv.className = 'vibe-coding-file-time';
  timeDiv.textContent = this.formatTime(new Date());
  
  // Create tool badge
  const toolBadge = document.createElement('div');
  toolBadge.className = 'vibe-coding-status-badge';
  toolBadge.textContent = toolData.tool;
  
  // Create status badge (ACCEPTED/REJECTED)
  const statusBadge = document.createElement('div');
  statusBadge.className = 'vibe-coding-approval-status-badge';
  if (isRejected) {
    statusBadge.classList.add('vibe-coding-status-rejected');
    statusBadge.textContent = 'REJECTED';
  } else {
    statusBadge.classList.add('vibe-coding-status-accepted');
    statusBadge.textContent = 'ACCEPTED';
  }
  
  // Append all elements
  fileItemDiv.appendChild(iconDiv);
  fileItemDiv.appendChild(infoDiv);
  fileItemDiv.appendChild(timeDiv);
  fileItemDiv.appendChild(toolBadge);
  fileItemDiv.appendChild(statusBadge);
  
  // Append to streaming container
  streamingContainer.appendChild(fileItemDiv);
}

// ... rest of existing methods ...













<div class="vibe-coding-file-list" #executedFileList>
  <!-- Empty State -->
  <div *ngIf="!isProcessing && executedItems.length === 0 && !currentApprovalRequest" class="vibe-coding-empty-state">
    <div class="vibe-coding-empty-state-icon">—</div>
    <p>No items executed yet</p>
  </div>

  <!-- Streaming Data Container - For READ items AND accepted/rejected files via DOM -->
  <div 
    *ngIf="showStreamingContainer" 
    id="vibe-coding-streaming-container"
    [@expandCollapse]="showStreamingContainer ? 'expanded' : 'collapsed'">
  </div>
  
  <!-- REMOVED: File Operations (WRITE/MODIFY) Angular-rendered items -->
  <!-- All accepted/rejected files now appended to streaming container via DOM -->

  <!-- Approval Request (with animation) -->
  <div 
    *ngIf="showApprovalCard && currentApprovalRequest && hasFileDetails(currentApprovalRequest.data.content)" 
    class="vibe-coding-file-item vibe-coding-awaiting-approval"
    [@fadeSlide]>
    <!-- ... approval card content remains same ... -->
  </div>
</div>














// MODIFIED updateLists - no longer needed to group items
private updateLists(): void {
  this.executedItems = this.parserService.getCompletedTools();
  this.queuedItems = this.parserService.getPendingTools();
  // REMOVED: this.groupExecutedItems(); - no longer needed
}

// REMOVE groupExecutedItems method completely
