onGenerateComplete(data: { file: any, prompts: string, mode: string }): void {
  const fileId = data.file.fileID.toString();
  
  // Check if item already exists in history
  const existingItem = this.historyComponent?.historyItems.find((i: any) => i.id === fileId);
  
  if (existingItem) {
    // Item already exists, just select it and load results
    this.selectedHistoryItem = existingItem;
    this.loadResultsForItem(existingItem.id);
    return;
  }
  
  // Create new item if it doesn't exist
  const newItem = {
    id: fileId,
    name: data.file.fileName,
    displayDate: 'Created on ' + new Date().toLocaleDateString('en-US', {
      year: 'numeric',
      month: 'long',
      day: 'numeric',
      hour: '2-digit',
      minute: '2-digit'
    }),
    date: new Date(),
    progress: 'completed',
    status: 'completed' as 'not-generated' | 'in-progress' | 'completed',
    isClickable: true
  };

  // Add to history
  if (this.historyComponent) {
    this.historyComponent.addHistoryItem(newItem);
  }

  // Load results
  this.selectedHistoryItem = newItem;
  this.loadResultsForItem(newItem.id);
}
