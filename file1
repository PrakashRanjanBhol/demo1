  // âœ… Fix invalid Mermaid subgraph syntax: subgraph Something (Label)
    code = code.replace(/subgraph\s+([^\n]+?)\s*\((.*?)\)/g, (match, id, label) => {
        // Generate a safe ID by removing spaces & parentheses
        const safeId = id.replace(/\s+/g, '_').replace(/[()]/g, '');
        // Mermaid expects: subgraph safeId [Label]
        return `subgraph ${safeId} [${id.trim()} (${label.trim()})]`;
    });
