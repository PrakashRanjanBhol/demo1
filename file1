approveAndContinue(): void {
  if (!this.waitingForApproval || !this.currentWriteModifyTool) return;
  
  // Execute/log the approved tool if needed
  // (Already logged in processSingleTool, so just clear it)
  
  this.currentWriteModifyTool = null;
  this.waitingForApproval = false;
  this.isWaitingForUserApproval = false;
  
  this.triggerUpdate();
  
  // Process remaining queue
  this.processQueue();
  
  // IMPORTANT: After processQueue, check completion again
  // This handles the case where processQueue didn't trigger completion
  // because the last item was WRITE/MODIFY which set waitingForApproval=true
  // But we just reset it above, so check again
  if (!this.isStreamingActive && 
      this.processingQueue.length === 0 && 
      !this.waitingForApproval && 
      this.onCompletionCallback) {
    this.onCompletionCallback();
  }
}

private processQueue(): void {
  if (this.waitingForApproval) {
    return;
  }

  this.isProcessing = true;

  while (this.processingQueue.length > 0 && !this.waitingForApproval) {
    const tool = this.processingQueue.shift();
    
    if (!tool) continue;

    this.processSingleTool(tool);
  }

  this.isProcessing = false;

  // After processing queue, check completion status
  if (!this.isStreamingActive && 
      this.processingQueue.length === 0 && 
      !this.waitingForApproval && 
      this.onCompletionCallback) {
    this.onCompletionCallback();
  }
}
