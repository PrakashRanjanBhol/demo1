/* Code line wrapping - Bitbucket style */
.pr-review-container ::ng-deep .d2h-code-line-ctn,
.pr-review-container ::ng-deep .d2h-code-side-line-ctn {
    color: var(--bitbucket-file-comparator-text-primary) !important;
    white-space: pre-wrap !important;
    word-wrap: break-word !important;
    word-break: break-word !important;
    overflow-wrap: break-word !important;
    padding-left: 8px !important;
    padding-right: 8px !important;
}

/* Ensure code cells allow wrapping */
.pr-review-container ::ng-deep .d2h-code-line,
.pr-review-container ::ng-deep .d2h-code-side-line {
    background-color: var(--bitbucket-file-comparator-bg-primary) !important;
    color: var(--bitbucket-file-comparator-text-primary) !important;
    width: auto;
    overflow: visible !important;
    vertical-align: top !important;
}

/* Line number cells - Keep at top and minimal width */
.pr-review-container ::ng-deep .d2h-code-linenumber,
.pr-review-container ::ng-deep .d2h-code-side-linenumber {
    background-color: var(--bitbucket-file-comparator-bg-tertiary) !important;
    border-color: var(--bitbucket-file-comparator-border-primary) !important;
    color: var(--bitbucket-file-comparator-text-secondary) !important;
    width: 1%;
    min-width: 50px;
    max-width: 50px;
    white-space: nowrap;
    text-align: right;
    padding-right: 10px;
    padding-left: 10px;
    vertical-align: top !important;
    position: relative;
}

/* Remove horizontal scroll on diff wrapper */
.pr-review-container ::ng-deep .d2h-wrapper {
    border: none !important;
    overflow-x: auto !important;
    max-width: 100%;
}

/* Ensure table handles wrapping properly */
.pr-review-container ::ng-deep .d2h-diff-table {
    width: 100%;
    border-collapse: collapse;
    table-layout: fixed;
}

/* Fixed width for line number columns in unified view */
.pr-review-container ::ng-deep .d2h-file-diff .d2h-code-linenumber {
    width: 50px !important;
}

/* Fixed width for line number columns in side-by-side view */
.pr-review-container ::ng-deep .d2h-file-side-diff .d2h-code-side-linenumber {
    width: 50px !important;
}

/* Code columns take remaining space */
.pr-review-container ::ng-deep .d2h-file-diff .d2h-code-line {
    width: calc(50% - 50px) !important;
}

.pr-review-container ::ng-deep .d2h-file-side-diff .d2h-code-side-line {
    width: calc(25% - 25px) !important;
}

/* Handle long strings in code */
.pr-review-container ::ng-deep .d2h-code-line-ctn code,
.pr-review-container ::ng-deep .d2h-code-side-line-ctn code {
    white-space: pre-wrap !important;
    word-wrap: break-word !important;
    overflow-wrap: break-word !important;
}

/* For very long unbreakable strings (like URLs), allow breaking anywhere */
.pr-review-container ::ng-deep .d2h-code-line-ctn,
.pr-review-container ::ng-deep .d2h-code-side-line-ctn {
    overflow-wrap: anywhere !important;
    display: block;
}

/* Side-by-side mode specific wrapping */
.pr-review-container ::ng-deep .d2h-file-side-diff td {
    overflow: visible !important;
    vertical-align: top !important;
}

/* Better wrapping for inline changes (ins/del tags) */
.pr-review-container ::ng-deep .d2h-code-line ins,
.pr-review-container ::ng-deep .d2h-code-side-line ins,
.pr-review-container ::ng-deep .d2h-code-line del,
.pr-review-container ::ng-deep .d2h-code-side-line del {
    white-space: pre-wrap !important;
    word-wrap: break-word !important;
    overflow-wrap: break-word !important;
    text-decoration: none !important;
}

/* Container styles */
.diff-container {
    padding: 0;
    position: relative;
    overflow: auto;
    width: 100%;
    max-width: 100%;
}

.file-section {
    overflow: visible;
    width: 100%;
    max-width: 100%;
}

/* Scrollbar for diff container if needed */
.diff-container::-webkit-scrollbar {
    height: 8px;
    width: 8px;
}

.diff-container::-webkit-scrollbar-track {
    background: var(--bitbucket-file-comparator-bg-tertiary);
}

.diff-container::-webkit-scrollbar-thumb {
    background: var(--bitbucket-file-comparator-border-secondary);
    border-radius: 4px;
}

.diff-container::-webkit-scrollbar-thumb:hover {
    background: var(--bitbucket-file-comparator-text-secondary);
}
