const drawPolygon = (ctx, polygonJson) => {
  if (!polygonJson) return;

  const polygons = JSON.parse(polygonJson); // [[x1, y1, x2, y2, ..., xn, yn]]
  if (!polygons.length) return;

  ctx.strokeStyle = "#00FF00";
  ctx.lineWidth = 2;
  ctx.beginPath();

  const coords = polygons[0]; // First polygon only for now
  ctx.moveTo(coords[0], coords[1]);

  for (let i = 2; i < coords.length; i += 2) {
    ctx.lineTo(coords[i], coords[i + 1]);
  }

  ctx.closePath();
  ctx.stroke();
};








const onCanvasLoad = (canvasRef, image) => {
  const ctx = canvasRef.getContext("2d");
  const img = new Image();
  img.src = formatImage(image.image_data);

  img.onload = () => {
    canvasRef.width = img.width;
    canvasRef.height = img.height;
    ctx.drawImage(img, 0, 0);

    // If segmentation exists, draw it
    if (image.segmentation) {
      drawPolygon(ctx, image.segmentation);
    } else if (image.boundingbox) {
      drawBoundingBox(ctx, image.boundingbox); // fallback
    }
  };
};


