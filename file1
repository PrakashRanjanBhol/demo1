import { Component, OnInit } from '@angular/core';

interface AccentColor {
  id: string;
  name: string;
  class: string;
}

interface CodeTheme {
  id: string;
  name: string;
  description: string;
  previewClass: string;
}

@Component({
  selector: 'app-settings',
  templateUrl: './app-settings.component.html',
  styleUrls: ['./app-settings.component.css']
})
export class AppSettingsComponent implements OnInit {
  isPanelOpen = false;
  
  accentColors: AccentColor[] = [
    { id: 'default', name: 'Default', class: 'color-default' },
    { id: 'blue', name: 'Blue', class: 'color-blue' },
    { id: 'green', name: 'Green', class: 'color-green' },
    { id: 'yellow', name: 'Yellow', class: 'color-yellow' },
    { id: 'orange', name: 'Orange', class: 'color-orange' },
    { id: 'pink', name: 'Pink', class: 'color-pink' }
  ];

  codeThemes: CodeTheme[] = [
    { id: 'github-dark', name: 'GitHub Dark', description: 'Dark theme inspired by GitHub', previewClass: 'preview-github-dark' },
    { id: 'monokai', name: 'Monokai', description: 'Classic colorful dark theme', previewClass: 'preview-monokai' },
    { id: 'dracula', name: 'Dracula', description: 'Popular dark theme with purple tones', previewClass: 'preview-dracula' },
    { id: 'nord', name: 'Nord', description: 'Arctic-inspired cool colors', previewClass: 'preview-nord' },
    { id: 'github', name: 'GitHub Light', description: 'Clean light theme', previewClass: 'preview-github' },
    { id: 'vs', name: 'Visual Studio', description: 'Classic VS light theme', previewClass: 'preview-vs' }
  ];

  selectedAccentColor = 'default';
  selectedCodeTheme = 'github-dark';

  ngOnInit(): void {
    // Load saved preferences from localStorage
    const savedColor = localStorage.getItem('accentColor');
    const savedTheme = localStorage.getItem('codeTheme');

    if (savedColor) {
      this.selectedAccentColor = savedColor;
    }

    if (savedTheme) {
      this.selectedCodeTheme = savedTheme;
    }
  }

  openSettings(): void {
    this.isPanelOpen = true;
  }

  closeSettings(): void {
    this.isPanelOpen = false;
  }

  selectColor(colorId: string): void {
    this.selectedAccentColor = colorId;
    localStorage.setItem('accentColor', colorId);
    console.log('Selected accent color:', colorId);
    
    // You can emit an event or call a service here to apply the color theme
    // this.themeService.setAccentColor(colorId);
  }

  selectTheme(themeId: string): void {
    this.selectedCodeTheme = themeId;
    localStorage.setItem('codeTheme', themeId);
    console.log('Selected code theme:', themeId);
    
    // You can load the highlight.js theme here
    // Example: this.loadHighlightJsTheme(themeId);
  }

  isColorSelected(colorId: string): boolean {
    return this.selectedAccentColor === colorId;
  }

  isThemeSelected(themeId: string): boolean {
    return this.selectedCodeTheme === themeId;
  }

  // Optional: Method to load highlight.js theme dynamically
  private loadHighlightJsTheme(theme: string): void {
    const link = document.getElementById('highlight-theme') as HTMLLinkElement;
    if (link) {
      link.href = `https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/${theme}.min.css`;
    }
  }
}









<!-- Settings Icon -->
<svg class="settings-icon" (click)="openSettings()" viewBox="0 0 24 24" fill="none">
    <line x1="4" y1="6" x2="12" y2="6"/>
    <circle cx="14" cy="6" r="2"/>
    <line x1="16" y1="6" x2="20" y2="6"/>
    <line x1="4" y1="12" x2="8" y2="12"/>
    <circle cx="10" cy="12" r="2"/>
    <line x1="12" y1="12" x2="20" y2="12"/>
    <line x1="4" y1="18" x2="14" y2="18"/>
    <circle cx="16" cy="18" r="2"/>
    <line x1="18" y1="18" x2="20" y2="18"/>
</svg>

<!-- App Settings Panel -->
<div class="app-settings-panel" [class.active]="isPanelOpen">
    <div class="panel-header">
        <div class="panel-header-top">
            <h2>App Settings</h2>
            <button class="close-btn" (click)="closeSettings()">&times;</button>
        </div>
        <p class="panel-subtitle">Customize your experience</p>
    </div>

    <div class="panel-content">
        <!-- Accent Color Section -->
        <div class="settings-section">
            <div class="section-header">
                <div class="section-title">Accent Color</div>
                <p class="section-description">Choose your preferred color theme</p>
            </div>
            <div class="color-grid">
                <div *ngFor="let color of accentColors" 
                     class="color-option" 
                     [class.selected]="isColorSelected(color.id)"
                     (click)="selectColor(color.id)">
                    <div class="color-option-inner">
                        <div class="color-circle" [ngClass]="color.class"></div>
                        <div class="color-name">{{ color.name }}</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Code Highlighter Theme Section -->
        <div class="settings-section">
            <div class="section-header">
                <div class="section-title">Code Highlighter Theme</div>
                <p class="section-description">Select your syntax highlighting style</p>
            </div>
            <div class="theme-list">
                <div *ngFor="let theme of codeThemes" 
                     class="theme-option" 
                     [class.selected]="isThemeSelected(theme.id)"
                     (click)="selectTheme(theme.id)">
                    <div class="theme-info">
                        <div class="theme-preview" [ngClass]="theme.previewClass"></div>
                        <div class="theme-details">
                            <h4>{{ theme.name }}</h4>
                            <p>{{ theme.description }}</p>
                        </div>
                    </div>
                    <div class="theme-check"></div>
                </div>
            </div>
        </div>
    </div>
</div>













/* Settings Icon */
.settings-icon {
    width: 22px;
    height: 22px;
    cursor: pointer;
    position: fixed;
    top: 20px;
    right: 20px;
    z-index: 999;
    transition: transform 0.2s ease;
}

.settings-icon:hover {
    transform: rotate(45deg);
}

.settings-icon line {
    stroke: #333;
    stroke-width: 2;
    stroke-linecap: round;
}

.settings-icon circle {
    fill: #333;
}

/* App Settings Panel */
.app-settings-panel {
    position: fixed;
    top: 64px;
    right: -320px;
    width: 320px;
    height: calc(100% - 64px - 30px);
    background: white;
    border-left: 1px solid #e5e7eb;
    transition: right 0.3s ease;
    z-index: 1000;
    overflow-y: auto;
}

.app-settings-panel.active {
    right: 0;
}

/* Scrollbar styling */
.app-settings-panel::-webkit-scrollbar {
    width: 6px;
}

.app-settings-panel::-webkit-scrollbar-track {
    background: #f1f1f1;
}

.app-settings-panel::-webkit-scrollbar-thumb {
    background: #d1d5db;
    border-radius: 3px;
}

.app-settings-panel::-webkit-scrollbar-thumb:hover {
    background: #9ca3af;
}

/* Panel Header */
.panel-header {
    padding: 24px 20px 20px;
    border-bottom: 1px solid #f3f4f6;
    position: sticky;
    top: 0;
    background: white;
    z-index: 10;
}

.panel-header-top {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 8px;
}

.panel-header h2 {
    font-size: 18px;
    font-weight: 600;
    color: #111827;
}

.close-btn {
    background: none;
    border: none;
    font-size: 24px;
    cursor: pointer;
    color: #6b7280;
    width: 28px;
    height: 28px;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 4px;
    transition: all 0.2s ease;
}

.close-btn:hover {
    background: #f3f4f6;
    color: #111827;
}

.panel-subtitle {
    font-size: 13px;
    color: #6b7280;
    margin: 0;
}

/* Panel Content */
.panel-content {
    padding: 0;
}

/* Settings Section */
.settings-section {
    padding: 24px 20px;
    border-bottom: 1px solid #f3f4f6;
}

.settings-section:last-child {
    border-bottom: none;
}

.section-header {
    margin-bottom: 16px;
}

.section-title {
    font-size: 13px;
    font-weight: 600;
    color: #374151;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    margin-bottom: 4px;
}

.section-description {
    font-size: 12px;
    color: #9ca3af;
    margin: 0;
}

/* Accent Color Selection */
.color-grid {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 12px;
}

.color-option {
    position: relative;
    cursor: pointer;
    border-radius: 8px;
    overflow: hidden;
    transition: all 0.2s ease;
    border: 2px solid transparent;
    background: #f9fafb;
}

.color-option:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
}

.color-option.selected {
    border-color: #3b82f6;
    background: #eff6ff;
}

.color-option-inner {
    padding: 16px 12px;
    text-align: center;
}

.color-circle {
    width: 24px;
    height: 24px;
    border-radius: 50%;
    margin: 0 auto 8px;
    position: relative;
}

.color-option.selected .color-circle::after {
    content: '✓';
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    color: white;
    font-size: 11px;
    font-weight: bold;
}

.color-name {
    font-size: 12px;
    color: #374151;
    font-weight: 500;
}

/* Color values */
.color-default { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); }
.color-blue { background: #3b82f6; }
.color-green { background: #10b981; }
.color-yellow { background: #f59e0b; }
.color-orange { background: #f97316; }
.color-pink { background: #ec4899; }

/* Theme Selection */
.theme-list {
    display: flex;
    flex-direction: column;
    gap: 8px;
}

.theme-option {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 12px 14px;
    border-radius: 8px;
    cursor: pointer;
    transition: all 0.2s ease;
    border: 1.5px solid #e5e7eb;
    background: white;
}

.theme-option:hover {
    border-color: #d1d5db;
    background: #f9fafb;
}

.theme-option.selected {
    border-color: #3b82f6;
    background: #eff6ff;
}

.theme-info {
    display: flex;
    align-items: center;
    gap: 12px;
}

.theme-preview {
    width: 40px;
    height: 28px;
    border-radius: 4px;
    display: flex;
    overflow: hidden;
    border: 1px solid #e5e7eb;
}

.theme-preview span {
    flex: 1;
}

.theme-details h4 {
    font-size: 13px;
    color: #111827;
    font-weight: 500;
    margin-bottom: 2px;
}

.theme-details p {
    font-size: 11px;
    color: #9ca3af;
    margin: 0;
}

.theme-check {
    width: 18px;
    height: 18px;
    border-radius: 50%;
    border: 2px solid #d1d5db;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.2s ease;
}

.theme-option.selected .theme-check {
    border-color: #3b82f6;
    background: #3b82f6;
}

.theme-option.selected .theme-check::after {
    content: '✓';
    color: white;
    font-size: 10px;
    font-weight: bold;
}

/* Theme preview colors */
.preview-github-dark { background: linear-gradient(to right, #0d1117 0%, #161b22 50%, #21262d 100%); }
.preview-monokai { background: linear-gradient(to right, #272822 0%, #49483e 50%, #75715e 100%); }
.preview-dracula { background: linear-gradient(to right, #282a36 0%, #44475a 50%, #6272a4 100%); }
.preview-nord { background: linear-gradient(to right, #2e3440 0%, #3b4252 50%, #434c5e 100%); }
.preview-github { background: linear-gradient(to right, #ffffff 0%, #f6f8fa 50%, #e1e4e8 100%); }
.preview-vs { background: linear-gradient(to right, #ffffff 0%, #f3f3f3 50%, #e8e8e8 100%); }
