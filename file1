// SIMPLIFIED getDiffHtml - Much faster, minimal DOM manipulation
public getDiffHtml(originalCode: string, modifiedCode: string, filename: string): string {
  const original = (originalCode || '').split('\n');
  const modified = (modifiedCode || '').split('\n');
  
  // Safety check - limit lines for performance
  const maxLines = 500;
  if (original.length > maxLines || modified.length > maxLines) {
    return `<div class="vibe-coding-diff-line">File too large to display diff (max ${maxLines} lines)</div>`;
  }
  
  const language = this.getLanguageFromFilename(filename);
  const lines: string[] = [];
  let originalLineNum = 1;
  let modifiedLineNum = 1;
  
  const maxLen = Math.max(original.length, modified.length);
  
  for (let i = 0; i < maxLen; i++) {
    const origLine = i < original.length ? original[i] : null;
    const modLine = i < modified.length ? modified[i] : null;
    
    if (origLine === modLine && origLine !== null) {
      // Unchanged line
      const escapedCode = this.escapeHtml(origLine);
      lines.push(
        `<div class="vibe-coding-diff-line vibe-coding-unchanged">` +
        `<span class="vibe-coding-line-number">${originalLineNum}</span>` +
        `<span class="vibe-coding-line-number">${modifiedLineNum}</span>` +
        `<span class="vibe-coding-line-prefix">  </span>` +
        `<span class="vibe-coding-line-content">${escapedCode}</span>` +
        `</div>`
      );
      originalLineNum++;
      modifiedLineNum++;
    } else {
      // Changed lines - show removed then added
      if (origLine !== null) {
        const escapedCode = this.escapeHtml(origLine);
        lines.push(
          `<div class="vibe-coding-diff-line vibe-coding-removed">` +
          `<span class="vibe-coding-line-number">${originalLineNum}</span>` +
          `<span class="vibe-coding-line-number"></span>` +
          `<span class="vibe-coding-line-prefix">- </span>` +
          `<span class="vibe-coding-line-content">${escapedCode}</span>` +
          `</div>`
        );
        originalLineNum++;
      }
      
      if (modLine !== null) {
        const escapedCode = this.escapeHtml(modLine);
        lines.push(
          `<div class="vibe-coding-diff-line vibe-coding-added">` +
          `<span class="vibe-coding-line-number"></span>` +
          `<span class="vibe-coding-line-number">${modifiedLineNum}</span>` +
          `<span class="vibe-coding-line-prefix">+ </span>` +
          `<span class="vibe-coding-line-content">${escapedCode}</span>` +
          `</div>`
        );
        modifiedLineNum++;
      }
    }
  }
  
  return lines.join('');
}

// REMOVE these methods - no longer needed:
// - computeDiff()
// - highlightCode()

// KEEP this simple helper
private escapeHtml(text: string): string {
  if (!text) return '';
  const div = document.createElement('div');
  div.textContent = text;
  return div.innerHTML;
}

// REMOVE getLanguageFromFilename - no longer needed for this simplified version
