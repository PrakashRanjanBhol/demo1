<!-- Updated filters-content section - Replace your existing .filters-content div -->

<div class="filters-content">
  <div class="search-box">
    <svg class="search-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
    </svg>
    <input 
      type="text" 
      class="search-input" 
      placeholder="Search PRs..." 
      [(ngModel)]="searchQuery"
      (input)="handleSearch()">
  </div>

  <!-- Date Range Picker Section -->
  <div class="date-range-section">
    <label class="filter-label">
      <svg class="label-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"></path>
      </svg>
      Date Range
    </label>
    <div class="date-range-inputs">
      <div class="date-input-wrapper">
        <input 
          type="text" 
          class="date-input" 
          placeholder="DD-MM-YYYY"
          [(ngModel)]="startDateDisplay"
          (blur)="onStartDateChange()"
          (keyup.enter)="onStartDateChange()"
          maxlength="10">
        <svg class="calendar-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"></path>
        </svg>
      </div>
      <span class="date-separator">to</span>
      <div class="date-input-wrapper">
        <input 
          type="text" 
          class="date-input" 
          placeholder="DD-MM-YYYY"
          [(ngModel)]="endDateDisplay"
          (blur)="onEndDateChange()"
          (keyup.enter)="onEndDateChange()"
          maxlength="10">
        <svg class="calendar-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"></path>
        </svg>
      </div>
    </div>
    <button 
      class="clear-dates-btn" 
      *ngIf="startDateDisplay || endDateDisplay"
      (click)="clearDateRange()">
      <svg class="clear-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
      </svg>
      Clear Dates
    </button>
  </div>

  <div class="sort-controls">
    <div class="sort-tabs">
      <button 
        class="sort-btn"
        [class.active]="currentSort === 'status'"
        (click)="sortPRs('status')">
        <svg class="sort-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path>
        </svg>
        <span>Status</span>
      </button>
      <button 
        class="sort-btn"
        [class.active]="currentSort === 'activity'"
        (click)="sortPRs('activity')">
        <svg class="sort-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 8h10M7 12h4m1 8l-4-4H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-3l-4 4z"></path>
        </svg>
        <span>Activity</span>
      </button>
    </div>

    <div class="order-controls">
      <!-- Status Order Controls -->
      <ng-container *ngIf="currentSort === 'status'">
        <button 
          class="order-btn"
          [class.active]="currentOrder === 'open'"
          (click)="setStatusOrder('open')">
          <svg class="order-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6-2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
          </svg>
          <span>Open</span>
        </button>
        <button 
          class="order-btn"
          [class.active]="currentOrder === 'merged'"
          (click)="setStatusOrder('merged')">
          <svg class="order-icon" fill="currentColor" viewBox="0 0 24 24">
            <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/>
          </svg>
          <span>Merged</span>
        </button>
      </ng-container>

      <!-- Activity Order Controls -->
      <ng-container *ngIf="currentSort === 'activity'">
        <button 
          class="order-btn"
          [class.active]="activityOrder === 'asc'"
          (click)="setActivityOrder('asc')">
          <svg class="order-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 4h13M3 8h9m-9 4h9m5-4v12m0 0l-4-4m4 4l4-4"></path>
          </svg>
          <span>Low → High</span>
        </button>
        <button 
          class="order-btn"
          [class.active]="activityOrder === 'desc'"
          (click)="setActivityOrder('desc')">
          <svg class="order-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 4h13M3 8h9m-9 4h6m4 0l4-4m0 0l4 4m-4-4v12"></path>
          </svg>
          <span>High → Low</span>
        </button>
      </ng-container>
    </div>
  </div>
</div>



















/* Add these styles to your CSS file for the date range picker */

.date-range-section {
  margin-bottom: 12px;
}

.filter-label {
  display: flex;
  align-items: center;
  gap: 6px;
  font-size: 12px;
  font-weight: 600;
  color: var(--bitbucket-prs-text-secondary);
  margin-bottom: 8px;
  text-transform: uppercase;
  letter-spacing: 0.5px;
}

.label-icon {
  width: 14px;
  height: 14px;
  color: var(--bitbucket-prs-accent-primary);
}

.date-range-inputs {
  display: flex;
  align-items: center;
  gap: 8px;
  margin-bottom: 8px;
}

.date-input-wrapper {
  position: relative;
  flex: 1;
}

.date-input {
  width: 100%;
  padding: 10px 32px 10px 12px;
  background: var(--bitbucket-prs-bg-secondary);
  border: 1px solid var(--bitbucket-prs-border-primary);
  border-radius: 6px;
  color: var(--bitbucket-prs-text-secondary);
  font-size: 12px;
  outline: none;
  transition: all 0.2s;
  font-family: monospace;
  letter-spacing: 0.5px;
}

.date-input::placeholder {
  color: var(--bitbucket-prs-text-muted);
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
  letter-spacing: normal;
}

.date-input:focus {
  background: var(--bitbucket-prs-bg-hover);
  border-color: var(--bitbucket-prs-accent-primary);
  box-shadow: var(--bitbucket-prs-shadow-focus);
}

.date-input.error {
  border-color: #ef4444;
}

.calendar-icon {
  position: absolute;
  right: 10px;
  top: 50%;
  transform: translateY(-50%);
  width: 16px;
  height: 16px;
  color: var(--bitbucket-prs-text-muted);
  pointer-events: none;
}

.date-separator {
  font-size: 11px;
  color: var(--bitbucket-prs-text-tertiary);
  font-weight: 500;
  padding: 0 2px;
}

.clear-dates-btn {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 6px;
  width: 100%;
  padding: 8px 12px;
  background: transparent;
  border: 1px solid var(--bitbucket-prs-border-primary);
  border-radius: 6px;
  color: var(--bitbucket-prs-text-tertiary);
  font-size: 11px;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.2s;
}

.clear-dates-btn:hover {
  background: var(--bitbucket-prs-bg-hover);
  border-color: var(--bitbucket-prs-border-secondary);
  color: var(--bitbucket-prs-text-secondary);
}

.clear-icon {
  width: 14px;
  height: 14px;
}















// Add these properties and methods to your component class

export class PrSidebarComponent implements OnInit {
  // ... existing properties ...
  
  // Date range properties
  startDateDisplay: string = '';
  endDateDisplay: string = '';
  startDate: Date | null = null;
  endDate: Date | null = null;

  // ... existing methods ...

  // Date formatting and validation methods
  private formatDateToDisplay(date: Date | null): string {
    if (!date) return '';
    const day = String(date.getDate()).padStart(2, '0');
    const month = String(date.getMonth() + 1).padStart(2, '0');
    const year = date.getFullYear();
    return `${day}-${month}-${year}`;
  }

  private parseDisplayDate(displayDate: string): Date | null {
    if (!displayDate) return null;
    
    // Remove any non-numeric characters except hyphens
    const cleaned = displayDate.replace(/[^\d-]/g, '');
    
    // Check if format matches DD-MM-YYYY
    const regex = /^(\d{2})-(\d{2})-(\d{4})$/;
    const match = cleaned.match(regex);
    
    if (!match) return null;
    
    const day = parseInt(match[1], 10);
    const month = parseInt(match[2], 10);
    const year = parseInt(match[3], 10);
    
    // Validate ranges
    if (month < 1 || month > 12) return null;
    if (day < 1 || day > 31) return null;
    if (year < 1900 || year > 2100) return null;
    
    // Create date and validate it's real (e.g., not Feb 31)
    const date = new Date(year, month - 1, day);
    if (date.getDate() !== day || date.getMonth() !== month - 1 || date.getFullYear() !== year) {
      return null;
    }
    
    return date;
  }

  private formatDateInput(value: string): string {
    // Remove any non-numeric characters
    let cleaned = value.replace(/\D/g, '');
    
    // Limit to 8 digits (DDMMYYYY)
    cleaned = cleaned.substring(0, 8);
    
    // Add hyphens automatically
    if (cleaned.length >= 2) {
      cleaned = cleaned.substring(0, 2) + '-' + cleaned.substring(2);
    }
    if (cleaned.length >= 5) {
      cleaned = cleaned.substring(0, 5) + '-' + cleaned.substring(5);
    }
    
    return cleaned;
  }

  onStartDateChange(): void {
    // Format input as user types
    this.startDateDisplay = this.formatDateInput(this.startDateDisplay);
    
    // Parse and validate the date
    const parsed = this.parseDisplayDate(this.startDateDisplay);
    
    if (parsed) {
      this.startDate = parsed;
      this.updatePRList();
    } else if (this.startDateDisplay === '') {
      this.startDate = null;
      this.updatePRList();
    }
  }

  onEndDateChange(): void {
    // Format input as user types
    this.endDateDisplay = this.formatDateInput(this.endDateDisplay);
    
    // Parse and validate the date
    const parsed = this.parseDisplayDate(this.endDateDisplay);
    
    if (parsed) {
      this.endDate = parsed;
      this.updatePRList();
    } else if (this.endDateDisplay === '') {
      this.endDate = null;
      this.updatePRList();
    }
  }

  clearDateRange(): void {
    this.startDateDisplay = '';
    this.endDateDisplay = '';
    this.startDate = null;
    this.endDate = null;
    this.updatePRList();
  }

  // Update the getFilteredPRs method to include date filtering
  private getFilteredPRs(): PullRequest[] {
    let filtered = this.prData;

    // Apply search filter
    if (this.searchQuery) {
      const query = this.searchQuery.toLowerCase();
      filtered = filtered.filter(pr => {
        return (
          pr.title.toLowerCase().includes(query) ||
          pr.author.toLowerCase().includes(query) ||
          pr.reviewers.some(reviewer => reviewer.toLowerCase().includes(query)) ||
          pr.id.toString().includes(query) ||
          pr.state.toLowerCase().includes(query)
        );
      });
    }

    // Apply date range filter
    // Note: You'll need to add a 'created_at' or 'updated_at' field to your PullRequest interface
    // and prData for this to work. Example implementation:
    /*
    if (this.startDate || this.endDate) {
      filtered = filtered.filter(pr => {
        const prDate = new Date(pr.created_at); // or pr.updated_at
        
        if (this.startDate && prDate < this.startDate) {
          return false;
        }
        
        if (this.endDate) {
          const endOfDay = new Date(this.endDate);
          endOfDay.setHours(23, 59, 59, 999);
          if (prDate > endOfDay) {
            return false;
          }
        }
        
        return true;
      });
    }
    */

    return filtered;
  }

  // ... rest of the component ...
}

// Optional: Add created_at or updated_at to your PullRequest interface
interface PullRequest {
  id: number;
  title: string;
  state: 'OPEN' | 'MERGED';
  author: string;
  reviewers: string[];
  user_comments: number;
  url: string;
  created_at?: string; // Add this field for date filtering (ISO format: '2024-01-15T10:30:00Z')
  updated_at?: string; // Or use this field
}
