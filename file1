/* Additional CSS to add to launcher-popup.component.css */

/* Downloading state styles */
.launcher-download-btn.launcher-downloading {
    opacity: 0.7;
    cursor: not-allowed;
}

.launcher-download-btn:disabled {
    pointer-events: none;
}

/* Spinner animation for downloading state */
.launcher-spinner {
    animation: launcher-spin 1s linear infinite;
}

@keyframes launcher-spin {
    from {
        transform: rotate(0deg);
    }
    to {
        transform: rotate(360deg);
    }
}

/* Optional: Pulse effect for downloading */
.launcher-download-btn.launcher-downloading {
    animation: launcher-pulse 1.5s ease-in-out infinite;
}

@keyframes launcher-pulse {
    0%, 100% {
        opacity: 0.7;
    }
    50% {
        opacity: 1;
    }
}









<!-- Modified section in launcher-popup.component.html -->
<!-- Replace the download button section with this: -->

<button 
  class="launcher-download-btn" 
  (click)="downloadLauncher()" 
  [class.launcher-downloaded]="isDownloaded"
  [class.launcher-downloading]="isDownloading"
  [disabled]="isDownloading">
  
  <!-- Downloading state (if using HttpClient version) -->
  <svg *ngIf="isDownloading" width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24"
    stroke-width="2" class="launcher-spinner">
    <circle cx="12" cy="12" r="10" stroke-opacity="0.25"/>
    <path d="M12 2a10 10 0 0 1 10 10" stroke-linecap="round"/>
  </svg>
  
  <!-- Downloaded state -->
  <svg *ngIf="isDownloaded && !isDownloading" width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24"
    stroke-width="2">
    <path stroke-linecap="round" stroke-linejoin="round" d="M5 13l4 4L19 7" />
  </svg>
  
  <!-- Default state -->
  <svg *ngIf="!isDownloaded && !isDownloading" width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24"
    stroke-width="2">
    <path stroke-linecap="round" stroke-linejoin="round"
      d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4" />
  </svg>
  
  {{ isDownloading ? 'Downloading...' : (isDownloaded ? 'Downloaded!' : 'Download Launcher') }}
</button>













// Alternative implementation using HttpClient (Better for larger files)
// launcher-popup.component.ts

import { Component, OnInit, OnDestroy } from '@angular/core';
import { CommonModule } from '@angular/common';
import { HttpClient } from '@angular/common/http';
import { LauncherThemeService } from './launcher-theme.service';
import { Subscription } from 'rxjs';

@Component({
  selector: 'app-launcher-popup',
  standalone: true,
  imports: [CommonModule],
  templateUrl: './launcher-popup.component.html',
  styleUrls: ['./launcher-popup.component.css']
})
export class LauncherPopupComponent implements OnInit, OnDestroy {
  isModalOpen = false;
  isDownloaded = false;
  isDownloading = false;
  currentTheme: 'dark' | 'light' = 'dark';
  private themeSubscription?: Subscription;

  constructor(
    private themeService: LauncherThemeService,
    private http: HttpClient
  ) {}

  ngOnInit(): void {
    this.themeSubscription = this.themeService.theme$.subscribe(theme => {
      this.currentTheme = theme;
    });
  }

  ngOnDestroy(): void {
    this.themeSubscription?.unsubscribe();
  }

  openModal(): void {
    this.isModalOpen = true;
  }

  closeModal(): void {
    this.isModalOpen = false;
  }

  downloadLauncher(): void {
    console.log('Downloading MyApp Launcher...');
    
    this.isDownloading = true;
    
    // Path to your .exe file in assets folder
    const exeFilePath = 'assets/MyAppLauncher.exe'; // Change this to your actual file name
    
    // Download the file as blob
    this.http.get(exeFilePath, { responseType: 'blob' }).subscribe({
      next: (blob: Blob) => {
        // Create a URL for the blob
        const url = window.URL.createObjectURL(blob);
        
        // Create a temporary anchor element to trigger download
        const link = document.createElement('a');
        link.href = url;
        link.download = 'MyAppLauncher.exe'; // This will be the downloaded file name
        
        // Append to body, click, and remove
        document.body.appendChild(link);
        link.click();
        document.body.removeChild(link);
        
        // Clean up the URL object
        window.URL.revokeObjectURL(url);
        
        // Show success state
        this.isDownloading = false;
        this.isDownloaded = true;

        setTimeout(() => {
          this.isDownloaded = false;
        }, 2000);
      },
      error: (error) => {
        console.error('Error downloading file:', error);
        this.isDownloading = false;
        alert('Failed to download the launcher. Please try again.');
      }
    });
  }

  onOverlayClick(event: MouseEvent): void {
    if ((event.target as HTMLElement).classList.contains('launcher-modal-overlay')) {
      this.closeModal();
    }
  }

  onEscapeKey(event: KeyboardEvent): void {
    if (event.key === 'Escape' && this.isModalOpen) {
      this.closeModal();
    }
  }

  toggleTheme(): void {
    this.themeService.toggleTheme();
  }
}
