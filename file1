// Update the @Output decorator:
@Output() onGenerationComplete = new EventEmitter<{ 
  id: number, 
  status: 'Success' | 'Failed',
  summary_prompt?: string,
  faq_prompt?: string
}>();







// Update the handleGenerationSuccess method:
private handleGenerationSuccess(): void {
  this.processingProgress = 100;
  this.generationStatus = 'success';
  
  // Emit success event to parent with the new format including prompts
  this.onGenerationComplete.emit({
    id: Number(this.processingFileId),
    status: 'Success',
    summary_prompt: this.summaryPrompt || undefined,
    faq_prompt: this.faqPrompt || undefined
  });

  // Emit the original onGenerate event for backward compatibility
  this.onGenerate.emit({
    file: {
      fileId: this.processingFileId,
      fileName: this.processingFileName
    },
    prompts: this.summaryPrompt + '\n\n' + this.faqPrompt,
    mode: 'new'
  });

  // Wait a bit to show the success state, then complete
  setTimeout(() => {
    this.completeProcessing();
  }, 2000);
}










// Update the handleGenerationError method:
private handleGenerationError(message: string): void {
  this.generationStatus = 'error';
  this.generationErrorMessage = message;
  this.isProcessing = false;
  this.processingProgress = 0;

  // Emit failure event to parent with the new format including prompts
  this.onGenerationComplete.emit({
    id: Number(this.processingFileId),
    status: 'Failed',
    summary_prompt: this.summaryPrompt || undefined,
    faq_prompt: this.faqPrompt || undefined
  });
}





// In your parent component class:
handleGenerationComplete(event: { 
  id: number, 
  status: 'Success' | 'Failed',
  summary_prompt?: string,
  faq_prompt?: string
}): void {
  console.log('Generation completed:', event);
  
  if (event.status === 'Success') {
    console.log(`File ${event.id} generated successfully`);
    
    // Access the prompts if user modified them
    if (event.summary_prompt) {
      console.log('Summary prompt used:', event.summary_prompt);
    }
    
    if (event.faq_prompt) {
      console.log('FAQ prompt used:', event.faq_prompt);
    }
    
    // Handle success - e.g., save prompts to database, update file record, etc.
  } else {
    console.log(`File ${event.id} generation failed`);
    
    // You can still access the prompts even on failure
    if (event.summary_prompt || event.faq_prompt) {
      console.log('Prompts used before failure:', {
        summary: event.summary_prompt,
        faq: event.faq_prompt
      });
    }
  }
}

