<!-- Model Selector - Update this section in panel-header -->
<div class="model-selector-container">
    <div class="model-selector-wrapper">
        <label class="model-selector-label">Model:</label>
        
        <!-- Show dropdown when models are loaded successfully -->
        <select class="model-dropdown" 
                *ngIf="!modelsLoadError"
                [(ngModel)]="selectedModel" 
                (change)="onModelChange(selectedModel)"
                [disabled]="isLoadingModels || isProcessing || isUploading">
            <option *ngFor="let model of availableModels" [value]="model">
                {{ model }}
            </option>
        </select>
        
        <!-- Show error indicator when loading fails -->
        <div class="model-error-indicator" *ngIf="modelsLoadError" [title]="modelsLoadError">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
                stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round"
                    d="M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126zM12 15.75h.007v.008H12v-.008z" />
            </svg>
            <span>Error</span>
        </div>
        
        <button class="model-refresh-btn" 
                (click)="refreshModels()" 
                [disabled]="isLoadingModels || isProcessing || isUploading"
                [title]="modelsLoadError ? 'Retry loading models' : 'Refresh models'">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
                stroke="currentColor" [class.spin]="isLoadingModels">
                <path stroke-linecap="round" stroke-linejoin="round"
                    d="M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0l3.181 3.183a8.25 8.25 0 0013.803-3.7M4.031 9.865a8.25 8.25 0 0113.803-3.7l3.181 3.182m0-4.991v4.99" />
            </svg>
        </button>
    </div>
</div>








/* Update Model Selector Styles */
.model-selector-container {
    display: flex;
    flex-direction: column;
    gap: 4px;
    flex-shrink: 0;
}

.model-selector-wrapper {
    display: flex;
    align-items: center;
    gap: 8px;
}

.model-selector-label {
    font-size: 12px;
    font-weight: 600;
    color: var(--text-color);
    white-space: nowrap;
}

.model-dropdown {
    padding: 6px 12px;
    background-color: var(--bg-color);
    border: 1px solid var(--border-color);
    border-radius: 6px;
    font-size: 13px;
    font-weight: 500;
    color: var(--text-color);
    cursor: pointer;
    transition: all 0.2s ease;
    min-width: 120px;
}

.model-dropdown:hover:not(:disabled) {
    border-color: var(--primary-color);
    background-color: var(--footer-bg);
}

.model-dropdown:focus {
    outline: none;
    border-color: var(--primary-color);
    box-shadow: 0 0 0 3px rgba(139, 92, 246, 0.1);
}

.model-dropdown:disabled {
    opacity: 0.5;
    cursor: not-allowed;
}

/* Model Error Indicator */
.model-error-indicator {
    display: flex;
    align-items: center;
    gap: 6px;
    padding: 6px 12px;
    background-color: rgba(239, 68, 68, 0.1);
    border: 1px solid rgba(239, 68, 68, 0.3);
    border-radius: 6px;
    cursor: help;
    min-width: 120px;
}

.model-error-indicator svg {
    width: 16px;
    height: 16px;
    stroke: #ef4444;
    flex-shrink: 0;
}

.model-error-indicator span {
    font-size: 13px;
    font-weight: 500;
    color: #ef4444;
}

.model-refresh-btn {
    width: 32px;
    height: 32px;
    padding: 6px;
    background-color: var(--footer-bg);
    border: 1px solid var(--border-color);
    border-radius: 6px;
    cursor: pointer;
    transition: all 0.2s ease;
    display: flex;
    align-items: center;
    justify-content: center;
}

.model-refresh-btn:hover:not(:disabled) {
    background: linear-gradient(135deg, var(--primary-color), #a78bfa);
    border-color: var(--primary-color);
    transform: translateY(-1px);
    box-shadow: 0 2px 8px rgba(139, 92, 246, 0.3);
}

.model-refresh-btn:hover:not(:disabled) svg {
    stroke: white;
}

.model-refresh-btn:active:not(:disabled) {
    transform: translateY(0);
}

.model-refresh-btn:disabled {
    opacity: 0.5;
    cursor: not-allowed;
}

.model-refresh-btn svg {
    width: 18px;
    height: 18px;
    stroke: var(--text-color);
    transition: all 0.3s ease;
}

.model-refresh-btn svg.spin {
    animation: spin 1s linear infinite;
}

@keyframes spin {
    from {
        transform: rotate(0deg);
    }
    to {
        transform: rotate(360deg);
    }
}

/* Remove the old error message style */
.model-error-message {
    /* Remove this entire block */
}
