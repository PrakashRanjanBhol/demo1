<div class="vibe-coding-file-list" #executedFileList>
  <!-- Empty State -->
  <div *ngIf="!isProcessing && executedItems.length === 0 && !currentApprovalRequest" class="vibe-coding-empty-state">
    <div class="vibe-coding-empty-state-icon">—</div>
    <p>No items executed yet</p>
  </div>

  <!-- Streaming Data Container - Always present, just animated -->
  <div 
    id="vibe-coding-streaming-container"
    [@expandCollapse]="showStreamingContainer ? 'expanded' : 'collapsed'">
  </div>
  
  <!-- Approval Request (with animation) -->
  <div 
    *ngIf="showApprovalCard && currentApprovalRequest && hasFileDetails(currentApprovalRequest.data.content)" 
    class="vibe-coding-file-item vibe-coding-awaiting-approval"
    [@fadeSlide]>
    <div class="vibe-coding-approval-header">
      <div class="vibe-coding-file-icon">{{ getFileExtension(getFileDetails(currentApprovalRequest.data.content)?.file_name) }}</div>
      <div class="vibe-coding-file-info">
        <div class="vibe-coding-file-name">{{ getFileDetails(currentApprovalRequest.data.content)?.file_name }}</div>
        <div class="vibe-coding-file-path">{{ getFileDetails(currentApprovalRequest.data.content)?.file_path }}</div>
      </div>
      <div class="vibe-coding-approval-badge">{{ currentApprovalRequest.data.tool }}</div>
    </div>
    
    <!-- Reasoning Box -->
    <div class="vibe-coding-reasoning-box" *ngIf="getReasoning(currentApprovalRequest.data.content)">
      <h3>Reasoning</h3>
      <p>{{ getReasoning(currentApprovalRequest.data.content) }}</p>
    </div>
    
    <!-- Code Changes Block with Diff Highlighting -->
    <div class="vibe-coding-diff-container" *ngIf="getFileDetails(currentApprovalRequest.data.content)">
      <div class="vibe-coding-diff-header">
        <span>Changes in {{ getFileDetails(currentApprovalRequest.data.content)?.file_name }}</span>
      </div>
      <div class="vibe-coding-code-block">
        <pre><code 
          [innerHTML]="getDiffHtml(
            getFileDetails(currentApprovalRequest.data.content)?.original_code || '', 
            getFileDetails(currentApprovalRequest.data.content)?.modified_code || '',
            getFileDetails(currentApprovalRequest.data.content)?.file_name || ''
          )">
        </code></pre>
      </div>
    </div>
    
    <!-- Approval Actions -->
    <div class="vibe-coding-approval-actions">
      <button 
        class="vibe-coding-approval-btn vibe-coding-reject" 
        (click)="rejectChanges()"
        [disabled]="isApprovingChanges">
        ✕ Reject
      </button>
      <button 
        class="vibe-coding-approval-btn vibe-coding-accept" 
        (click)="approveAndContinue()"
        [disabled]="isApprovingChanges">
        <span *ngIf="!isApprovingChanges">✓ Accept & Continue</span>
        <span *ngIf="isApprovingChanges" class="vibe-coding-accepting-wrapper">
          <span class="vibe-coding-inline-spinner"></span>
          Accepting Changes
        </span>
      </button>
    </div>
  </div>
</div>














animations: [
  trigger('fadeSlide', [
    state('void', style({
      opacity: 0,
      transform: 'translateY(-10px)'
    })),
    state('*', style({
      opacity: 1,
      transform: 'translateY(0)'
    })),
    transition('void => *', [
      animate('300ms ease-out')
    ]),
    transition('* => void', [
      animate('300ms ease-in')
    ])
  ]),
  trigger('expandCollapse', [
    state('collapsed', style({
      height: '0',
      opacity: 0,
      overflow: 'hidden',
      pointerEvents: 'none' // ADD THIS - prevent interaction when collapsed
    })),
    state('expanded', style({
      height: '*',
      opacity: 1,
      overflow: 'visible',
      pointerEvents: 'auto' // ADD THIS - allow interaction when expanded
    })),
    transition('collapsed <=> expanded', [
      animate('400ms ease-in-out')
    ])
  ])
]
