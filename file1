import React from "react";
import { Outlet, NavLink, useLocation } from "react-router-dom";
import { Tag } from "primereact/tag";
import type { NavItem } from "./types";
import styles from "./SettingsLayout.module.css";

const navItems: NavItem[] = [
  {
    id: "personal",
    label: "Personal Information",
    icon: "pi pi-user",
    path: "personal",
    description: "Manage your personal profile and contact details",
  },
  {
    id: "role",
    label: "Role Management",
    icon: "pi pi-shield",
    path: "role-management",
    description: "Control access levels and permission assignments",
  },
  {
    id: "rag",
    label: "RAG Management",
    icon: "pi pi-database",
    path: "rag-management",
    description: "Configure retrieval-augmented generation settings",
  },
  {
    id: "general",
    label: "General Settings",
    icon: "pi pi-cog",
    path: "general",
    description: "Adjust system preferences and configurations",
  },
];

const SettingsLayout: React.FC = () => {
  const location = useLocation();

  const activeItem = navItems.find((item) =>
    location.pathname.includes(item.path)
  );

  return (
    <div className={`${styles.wrapper} flex overflow-hidden`} style={{ height: "100%" }}>

      {/* ── Sidebar ── */}
      <aside className={`${styles.sidebar} flex flex-column flex-shrink-0 h-full`}>
        <nav className="flex flex-column p-3 gap-1">
          <span className={`${styles.navLabel} text-color-secondary font-semibold uppercase px-2 py-2`}>
            Settings
          </span>

          {navItems.map((item) => {
            const isActive = location.pathname.includes(item.path);
            return (
              <NavLink
                key={item.id}
                to={item.path}
                style={{ textDecoration: "none" }}
              >
                <div
                  className={`flex align-items-center gap-3 px-3 py-2 border-round-lg cursor-pointer ${
                    isActive ? "bg-primary-50" : "hover:surface-hover"
                  }`}
                  style={{
                    borderLeft: isActive
                      ? "3px solid var(--primary-color)"
                      : "3px solid transparent",
                    transition: "background 0.15s",
                  }}
                >
                  <i
                    className={item.icon}
                    style={{
                      color: isActive
                        ? "var(--primary-color)"
                        : "var(--text-color-secondary)",
                    }}
                  />
                  <span
                    className="font-medium"
                    style={{
                      color: isActive
                        ? "var(--primary-color)"
                        : "var(--text-color)",
                    }}
                  >
                    {item.label}
                  </span>
                </div>
              </NavLink>
            );
          })}
        </nav>
      </aside>

      {/* ── Main Panel ── */}
      <main className={`${styles.main} flex flex-column flex-1 overflow-hidden h-full`}>

        {/* Page header — fixed, never scrolls */}
        <div
          className="flex-shrink-0 flex align-items-center justify-content-between px-4 py-3"
          style={{ borderBottom: "1px solid var(--surface-border)" }}
        >
          <div>
            <div className="text-color-secondary text-xs mb-1">
              Settings &rsaquo; {activeItem?.label ?? ""}
            </div>
            <div className="text-900 font-semibold text-xl">
              {activeItem?.label ?? "Settings"}
            </div>
          </div>

          <div className="flex align-items-center gap-2">
            {activeItem && (
              <Tag
                value={activeItem.label}
                rounded
                severity="info"
                className="text-xs"
              />
            )}
          </div>
        </div>

        {/* Content area — scrolls only when content overflows */}
        <div className="flex-1 overflow-y-auto p-4">
          <Outlet />
        </div>

      </main>
    </div>
  );
};

export default SettingsLayout;
















.wrapper {
  gap: 1rem;
}

.sidebar {
  background: #ffffff;
  width: 240px;
  border-right: 1px solid var(--surface-border);
  font-size: 0.95rem;
}

.sidebar nav span {
  font-size: 0.8rem;
}

.sidebar .navLabel {
  font-size: 0.875rem;
}

.main {
  background: #ffffff;
}
