// center-content.component.ts
import { Component, OnInit } from '@angular/core';
import { CommonModule } from '@angular/common';
import { DomSanitizer, SafeHtml } from '@angular/platform-browser';
import hljs from 'highlight.js';
import { marked } from 'marked';

interface FileInfo {
  id: number;
  name: string;
  path: string;
  size: string;
  repository: string;
  content: string;
  type: string;
}

interface PRInfo {
  id: number;
  title: string;
  author: string;
  status: string;
  number: number;
  repository: string;
  sourceBranch: string;
  targetBranch: string;
  autoReview: boolean;
}

type ViewType = 'pr' | 'file' | null;

@Component({
  selector: 'app-center-content',
  standalone: true,
  imports: [CommonModule],
  templateUrl: './center-content.component.html',
  styleUrls: ['./center-content.component.css']
})
export class CenterContentComponent implements OnInit {
  // Static data for PRs
  prs: PRInfo[] = [
    {
      id: 1,
      title: 'Add user authentication',
      author: 'johndoe',
      status: 'open',
      number: 142,
      repository: 'frontend-app',
      sourceBranch: 'feature/auth',
      targetBranch: 'main',
      autoReview: true
    },
    {
      id: 2,
      title: 'Fix responsive layout',
      author: 'janedoe',
      status: 'review',
      number: 143,
      repository: 'frontend-app',
      sourceBranch: 'fix/responsive',
      targetBranch: 'develop',
      autoReview: false
    },
    {
      id: 3,
      title: 'Update dependencies',
      author: 'alice',
      status: 'open',
      number: 144,
      repository: 'backend-api',
      sourceBranch: 'chore/deps',
      targetBranch: 'main',
      autoReview: true
    }
  ];

  // Static data for Files with content
  files: FileInfo[] = [
    {
      id: 1,
      name: 'App.jsx',
      path: 'src/',
      size: '2.4 KB',
      repository: 'frontend-app',
      type: 'javascript',
      content: `import React from 'react';
import './App.css';

function App() {
  const [count, setCount] = React.useState(0);

  return (
    <div className="App">
      <header className="App-header">
        <h1>Welcome to React</h1>
        <p>You clicked {count} times</p>
        <button onClick={() => setCount(count + 1)}>
          Click me
        </button>
      </header>
    </div>
  );
}

export default App;`
    },
    {
      id: 2,
      name: 'index.css',
      path: 'src/',
      size: '1.2 KB',
      repository: 'frontend-app',
      type: 'css',
      content: `body {
  margin: 0;
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen',
    'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue',
    sans-serif;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

code {
  font-family: source-code-pro, Menlo, Monaco, Consolas, 'Courier New',
    monospace;
}

.App {
  text-align: center;
  min-height: 100vh;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  font-size: calc(10px + 2vmin);
}`
    },
    {
      id: 3,
      name: 'utils.js',
      path: 'src/lib/',
      size: '3.8 KB',
      repository: 'frontend-app',
      type: 'javascript',
      content: `// Utility functions for the application

/**
 * Format a date to a readable string
 * @param {Date} date - The date to format
 * @returns {string} Formatted date string
 */
export function formatDate(date) {
  const options = { year: 'numeric', month: 'long', day: 'numeric' };
  return date.toLocaleDateString(undefined, options);
}

/**
 * Debounce a function call
 * @param {Function} func - The function to debounce
 * @param {number} wait - The wait time in milliseconds
 * @returns {Function} Debounced function
 */
export function debounce(func, wait) {
  let timeout;
  return function executedFunction(...args) {
    const later = () => {
      clearTimeout(timeout);
      func(...args);
    };
    clearTimeout(timeout);
    timeout = setTimeout(later, wait);
  };
}

/**
 * Check if a value is empty
 * @param {*} value - The value to check
 * @returns {boolean} True if empty, false otherwise
 */
export function isEmpty(value) {
  return value === null || value === undefined || value === '';
}`
    },
    {
      id: 4,
      name: 'README.md',
      path: '/',
      size: '5.1 KB',
      repository: 'backend-api',
      type: 'markdown',
      content: `# Backend API

## Overview
This is the backend API for our application. It provides RESTful endpoints for managing users, posts, and comments.

## Features
- User authentication with JWT
- CRUD operations for posts
- Comment system
- File upload support
- Rate limiting
- API documentation with Swagger

## Installation

\`\`\`bash
npm install
\`\`\`

## Configuration

Create a \`.env\` file in the root directory:

\`\`\`
PORT=3000
DATABASE_URL=mongodb://localhost:27017/myapp
JWT_SECRET=your-secret-key
\`\`\`

## Usage

Start the development server:

\`\`\`bash
npm run dev
\`\`\`

## API Endpoints

### Authentication
- \`POST /api/auth/register\` - Register a new user
- \`POST /api/auth/login\` - Login user

### Posts
- \`GET /api/posts\` - Get all posts
- \`POST /api/posts\` - Create a new post
- \`PUT /api/posts/:id\` - Update a post
- \`DELETE /api/posts/:id\` - Delete a post

## Testing

\`\`\`bash
npm test
\`\`\`

## License
MIT`
    }
  ];

  // Current selections
  selectedPR: PRInfo | null = this.prs[0];
  selectedFile: FileInfo | null = null;
  activeView: ViewType = 'pr';
  
  // File viewer properties
  currentView: string = 'code';
  renderedContent: SafeHtml = '';
  showViewToggle: boolean = false;

  constructor(private sanitizer: DomSanitizer) {}

  ngOnInit(): void {
    // Initialize with first PR
    if (this.selectedPR) {
      this.activeView = 'pr';
    }
  }

  get hasContent(): boolean {
    return this.selectedPR !== null || this.selectedFile !== null;
  }

  // Method to switch to PR view
  selectPR(pr: PRInfo): void {
    this.selectedPR = pr;
    this.activeView = 'pr';
  }

  // Method to switch to File view
  selectFile(file: FileInfo): void {
    this.selectedFile = file;
    this.activeView = 'file';
    this.renderFileContent();
  }

  // Method to toggle between views (for demo purposes)
  toggleView(): void {
    if (this.activeView === 'pr') {
      this.selectFile(this.files[0]);
    } else {
      this.selectPR(this.prs[0]);
    }
  }

  // File viewer methods
  changeView(view: string): void {
    this.currentView = view;
    this.renderFileContent();
  }

  isViewActive(view: string): boolean {
    return this.currentView === view;
  }

  private renderFileContent(): void {
    if (!this.selectedFile) return;

    const fileType = this.selectedFile.type || 'plaintext';

    if (fileType === 'markdown') {
      this.showViewToggle = true;
      if (this.currentView === 'preview') {
        this.renderedContent = this.sanitizer.bypassSecurityTrustHtml(
          this.renderMarkdownView(this.selectedFile.content)
        );
      } else {
        this.renderedContent = this.sanitizer.bypassSecurityTrustHtml(
          this.renderCodeView(this.selectedFile.content, 'markdown')
        );
      }
    } else {
      this.showViewToggle = false;
      this.currentView = 'code';
      this.renderedContent = this.sanitizer.bypassSecurityTrustHtml(
        this.renderCodeView(this.selectedFile.content, fileType)
      );
    }
  }

  private escapeHtml(text: string): string {
    const map: { [key: string]: string } = {
      '&': '&amp;',
      '<': '&lt;',
      '>': '&gt;',
      '"': '&quot;',
      "'": '&#039;'
    };
    return text.replace(/[&<>"']/g, (m) => map[m]);
  }

  private renderCodeView(content: string, language: string): string {
    const lines = content.split('\n');
    
    let highlightedLines: string[];
    try {
      if (language && language !== 'markdown' && hljs.getLanguage(language)) {
        const highlighted = hljs.highlight(content, { language: language }).value;
        highlightedLines = highlighted.split('\n');
      } else {
        highlightedLines = lines.map(line => this.escapeHtml(line));
      }
    } catch (e) {
      highlightedLines = lines.map(line => this.escapeHtml(line));
    }

    const lineNumbers = highlightedLines
      .map((_, i) => `<div class="line-number">${i + 1}</div>`)
      .join('');

    const codeContent = highlightedLines
      .map(line => `<div class="code-line">${line || '&nbsp;'}</div>`)
      .join('');

    return `
      <div class="code-view">
        <div class="line-numbers">${lineNumbers}</div>
        <div class="code-lines">${codeContent}</div>
      </div>
    `;
  }

  private renderMarkdownView(content: string): string {
    try {
      const html = marked.parse(content) as string;
      return `<div class="markdown-view">${html}</div>`;
    } catch (e) {
      console.error('Markdown parsing error:', e);
      return `<div class="markdown-view"><p>Error rendering markdown</p></div>`;
    }
  }
}



























<!-- center-content.component.html -->
<div class="center">
  <!-- Header Section -->
  <div class="content-header" [class.hidden]="!hasContent">
    <!-- PR Header -->
    <ng-container *ngIf="activeView === 'pr' && selectedPR">
      <div class="breadcrumb animate-in">
        <svg class="breadcrumb-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <circle cx="18" cy="18" r="3"/>
          <circle cx="6" cy="6" r="3"/>
          <path d="M13 6h3a2 2 0 0 1 2 2v7"/>
          <line x1="6" y1="9" x2="6" y2="21"/>
        </svg>
        <span>Pull Request</span>
        <svg class="breadcrumb-separator" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <polyline points="9 18 15 12 9 6"/>
        </svg>
        <span>#{{ selectedPR.number }}</span>
      </div>
      <div class="main-heading animate-in">
        <svg class="main-heading-icon pr-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <circle cx="18" cy="18" r="3"/>
          <circle cx="6" cy="6" r="3"/>
          <path d="M13 6h3a2 2 0 0 1 2 2v7"/>
          <line x1="6" y1="9" x2="6" y2="21"/>
        </svg>
        <h1>{{ selectedPR.title }}</h1>
        <div class="auto-review-badge" *ngIf="selectedPR.autoReview" title="AI Auto Review Enabled">
          <svg class="auto-review-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"/>
          </svg>
          <span>AI Review</span>
        </div>
      </div>
      <div class="sub-info animate-in">
        <div class="info-badge">
          <svg class="badge-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"/>
          </svg>
          <span class="info-badge-label">Repository:</span> {{ selectedPR.repository }}
        </div>
        <div class="info-badge branch-badge">
          <svg class="badge-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <line x1="6" y1="3" x2="6" y2="15"/>
            <circle cx="18" cy="6" r="3"/>
            <circle cx="6" cy="18" r="3"/>
            <path d="M18 9a9 9 0 01-9 9"/>
          </svg>
          <span class="branch-name">{{ selectedPR.sourceBranch }}</span>
          <svg class="arrow-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <polyline points="9 18 15 12 9 6"/>
          </svg>
          <span class="branch-name">{{ selectedPR.targetBranch }}</span>
        </div>
        <div class="info-badge">
          <span class="info-badge-label">Author:</span> {{ selectedPR.author }}
        </div>
        <div class="info-badge">
          <span class="info-badge-label">Status:</span> 
          <span style="text-transform: capitalize;">{{ selectedPR.status }}</span>
        </div>
      </div>
    </ng-container>

    <!-- File Header -->
    <ng-container *ngIf="activeView === 'file' && selectedFile">
      <div class="breadcrumb animate-in">
        <svg class="breadcrumb-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
          <polyline points="14 2 14 8 20 8"/>
        </svg>
        <span>File</span>
        <svg class="breadcrumb-separator" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <polyline points="9 18 15 12 9 6"/>
        </svg>
        <span>{{ selectedFile.path }}</span>
      </div>
      <div class="main-heading animate-in">
        <svg class="main-heading-icon file-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
          <polyline points="14 2 14 8 20 8"/>
          <line x1="16" y1="13" x2="8" y2="13"/>
          <line x1="16" y1="17" x2="8" y2="17"/>
          <polyline points="10 9 9 9 8 9"/>
        </svg>
        <h1>{{ selectedFile.name }}</h1>
      </div>
      <div class="sub-info animate-in">
        <div class="info-badge">
          <svg class="badge-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"/>
          </svg>
          <span class="info-badge-label">Repository:</span> {{ selectedFile.repository }}
        </div>
        <div class="info-badge">
          <span class="info-badge-label">Path:</span> {{ selectedFile.path }}{{ selectedFile.name }}
        </div>
        <div class="info-badge">
          <span class="info-badge-label">Size:</span> {{ selectedFile.size }}
        </div>
        <!-- View Toggle for Markdown files -->
        <div class="view-toggle" *ngIf="showViewToggle">
          <button 
            class="toggle-btn" 
            [class.active]="isViewActive('code')"
            (click)="changeView('code')">
            Code
          </button>
          <button 
            class="toggle-btn" 
            [class.active]="isViewActive('preview')"
            (click)="changeView('preview')">
            Preview
          </button>
        </div>
      </div>
    </ng-container>
  </div>

  <!-- Content Area -->
  <div class="content">
    <!-- Empty State -->
    <div class="empty-state" *ngIf="!hasContent">
      <svg class="empty-state-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>
      </svg>
      <p>Select a PR or file to view details</p>
    </div>

    <!-- PR Content -->
    <div class="content-view" [class.active]="activeView === 'pr' && selectedPR" *ngIf="selectedPR">
      <div class="meta-grid">
        <div class="meta-item">
          <div class="meta-label">Pull Request</div>
          <div class="meta-value">#{{ selectedPR.number }}</div>
        </div>
        <div class="meta-item">
          <div class="meta-label">Status</div>
          <div class="meta-value" style="text-transform: capitalize;">{{ selectedPR.status }}</div>
        </div>
        <div class="meta-item">
          <div class="meta-label">Author</div>
          <div class="meta-value">{{ selectedPR.author }}</div>
        </div>
      </div>
      <div class="content-section">
        <h3 class="section-title">Description</h3>
        <div class="section-content">
          <p>This pull request implements the necessary changes for the feature. The implementation follows best practices and includes comprehensive test coverage.</p>
          <p style="margin-top: 12px;">Key changes include improved error handling, optimized performance, and enhanced user experience across all supported platforms.</p>
        </div>
      </div>
      <div class="content-section">
        <h3 class="section-title">Changes</h3>
        <div class="section-content">
          <p>• Added new authentication middleware</p>
          <p>• Updated user model with validation</p>
          <p>• Implemented JWT token handling</p>
          <p>• Added comprehensive unit tests</p>
        </div>
      </div>
    </div>

    <!-- File Content with Code Viewer -->
    <div class="content-view file-viewer-content" [class.active]="activeView === 'file' && selectedFile" *ngIf="selectedFile">
      <div class="file-content-wrapper">
        <div [innerHTML]="renderedContent"></div>
      </div>
    </div>
  </div>
</div>

  <!-- Content Area -->
  <div class="content">
    <!-- Empty State -->
    <div class="empty-state" *ngIf="!hasContent">
      <svg class="empty-state-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>
      </svg>
      <p>Select a PR or file to view details</p>
    </div>

    <!-- PR Content -->
    <div class="content-view" [class.active]="activeView === 'pr' && selectedPR" *ngIf="selectedPR">
      <div class="meta-grid">
        <div class="meta-item">
          <div class="meta-label">Pull Request</div>
          <div class="meta-value">#{{ selectedPR.number }}</div>
        </div>
        <div class="meta-item">
          <div class="meta-label">Status</div>
          <div class="meta-value" style="text-transform: capitalize;">{{ selectedPR.status }}</div>
        </div>
        <div class="meta-item">
          <div class="meta-label">Author</div>
          <div class="meta-value">{{ selectedPR.author }}</div>
        </div>
      </div>
      <div class="content-section">
        <h3 class="section-title">Description</h3>
        <div class="section-content">
          <p>This pull request implements the necessary changes for the feature. The implementation follows best practices and includes comprehensive test coverage.</p>
          <p style="margin-top: 12px;">Key changes include improved error handling, optimized performance, and enhanced user experience across all supported platforms.</p>
        </div>
      </div>
      <div class="content-section">
        <h3 class="section-title">Changes</h3>
        <div class="section-content">
          <p>• Added new authentication middleware</p>
          <p>• Updated user model with validation</p>
          <p>• Implemented JWT token handling</p>
          <p>• Added comprehensive unit tests</p>
        </div>
      </div>
    </div>

    <!-- File Content -->
    <div class="content-view" [class.active]="activeView === 'file' && selectedFile" *ngIf="selectedFile">
      <div class="content-section">
        <h3 class="section-title">File Content</h3>
        <div class="code-block">
          <pre>// {{ selectedFile.name }}
// Path: {{ selectedFile.path }}{{ selectedFile.name }}

function example() {{ '{' }}
  const greeting = "Hello World";
  console.log(greeting);
  return greeting;
{{ '}' }}

export default example;</pre>
        </div>
      </div>
    </div>
  </div>
</div>














/* center-content.component.css */

/* Light Mode Variables (Default) */
:root {
  /* Background Colors */
  --bitbucket-file-bg-primary: #ffffff;
  --bitbucket-file-bg-secondary: #f9fafb;
  --bitbucket-file-bg-tertiary: #f3f4f6;
  --bitbucket-file-bg-hover: #f3f4f6;
  --bitbucket-file-bg-code: #1f2937;
  
  /* Border Colors */
  --bitbucket-file-border-primary: #e5e7eb;
  --bitbucket-file-border-secondary: #d1d5db;
  
  /* Text Colors */
  --bitbucket-file-text-primary: #111827;
  --bitbucket-file-text-secondary: #374151;
  --bitbucket-file-text-tertiary: #6b7280;
  --bitbucket-file-text-muted: #9ca3af;
  --bitbucket-file-text-code: #f3f4f6;
  
  /* Accent Colors */
  --bitbucket-file-accent-blue: #3b82f6;
  --bitbucket-file-accent-green: #16a34a;
  --bitbucket-file-accent-purple: #9333ea;
  --bitbucket-file-accent-blue-light: #eff6ff;
  --bitbucket-file-accent-blue-border: #bfdbfe;
  --bitbucket-file-accent-purple-light: #faf5ff;
  --bitbucket-file-accent-purple-border: #e9d5ff;
  
  /* Gradient */
  --bitbucket-file-gradient-header: linear-gradient(to bottom, #ffffff 0%, #fafbfc 100%);
  
  /* File Viewer Specific */
  --bitbucket-file-view-bg-content: #ffffff;
  --bitbucket-file-view-bg-code-inline: #f6f8fa;
  --bitbucket-file-view-text-line-number: #57606a;
  --bitbucket-file-view-link: #0969da;
  --bitbucket-file-view-btn-bg: #f6f8fa;
  --bitbucket-file-view-btn-hover: #eaeef2;
  --bitbucket-file-view-btn-active: #0969da;
  --bitbucket-file-view-blockquote: #656d76;
}

/* Dark Mode Variables */
[data-theme="dark"] {
  /* Background Colors */
  --bitbucket-file-bg-primary: #0a0a0b;
  --bitbucket-file-bg-secondary: #151518;
  --bitbucket-file-bg-tertiary: #1f1f23;
  --bitbucket-file-bg-hover: #252529;
  --bitbucket-file-bg-code: #0d0d0e;
  
  /* Border Colors */
  --bitbucket-file-border-primary: #2a2a2e;
  --bitbucket-file-border-secondary: #3a3a3e;
  
  /* Text Colors */
  --bitbucket-file-text-primary: #e5e7eb;
  --bitbucket-file-text-secondary: #d1d5db;
  --bitbucket-file-text-tertiary: #9ca3af;
  --bitbucket-file-text-muted: #6b7280;
  --bitbucket-file-text-code: #f3f4f6;
  
  /* Accent Colors */
  --bitbucket-file-accent-blue: #60a5fa;
  --bitbucket-file-accent-green: #22c55e;
  --bitbucket-file-accent-purple: #a855f7;
  --bitbucket-file-accent-blue-light: #1e3a5f;
  --bitbucket-file-accent-blue-border: #1e40af;
  --bitbucket-file-accent-purple-light: #2e1065;
  --bitbucket-file-accent-purple-border: #6b21a8;
  
  /* Gradient */
  --bitbucket-file-gradient-header: linear-gradient(to bottom, #0a0a0b 0%, #151518 100%);
  
  /* File Viewer Specific */
  --bitbucket-file-view-bg-content: #111113;
  --bitbucket-file-view-bg-code-inline: #161b22;
  --bitbucket-file-view-text-line-number: #6e7681;
  --bitbucket-file-view-link: #58a6ff;
  --bitbucket-file-view-btn-bg: #21262d;
  --bitbucket-file-view-btn-hover: #30363d;
  --bitbucket-file-view-btn-active: #1f6feb;
  --bitbucket-file-view-blockquote: #7d8590;
}

/* Center Area */
.center {
  flex: 1;
  display: flex;
  flex-direction: column;
  background: var(--bitbucket-file-bg-primary);
  position: relative;
}

/* Content Header */
.content-header {
  padding: 20px 24px;
  border-bottom: 1px solid var(--bitbucket-file-border-primary);
  background: var(--bitbucket-file-gradient-header);
}

.content-header.hidden {
  display: none;
}

.breadcrumb {
  display: flex;
  align-items: center;
  gap: 8px;
  margin-bottom: 8px;
  font-size: 13px;
  color: var(--bitbucket-file-text-tertiary);
}

.breadcrumb-icon {
  width: 14px;
  height: 14px;
  color: var(--bitbucket-file-text-tertiary);
}

.breadcrumb-separator {
  width: 14px;
  height: 14px;
  color: var(--bitbucket-file-border-secondary);
}

.main-heading {
  display: flex;
  align-items: center;
  gap: 12px;
  flex-wrap: wrap;
}

.main-heading-icon {
  width: 24px;
  height: 24px;
  color: var(--bitbucket-file-accent-blue);
  flex-shrink: 0;
}

.main-heading-icon.pr-icon {
  color: var(--bitbucket-file-accent-green);
}

.main-heading-icon.file-icon {
  color: var(--bitbucket-file-accent-blue);
}

.main-heading h1 {
  font-size: 28px;
  font-weight: 700;
  color: var(--bitbucket-file-text-primary);
  flex: 1;
  min-width: 0;
}

/* Auto Review Badge */
.auto-review-badge {
  display: inline-flex;
  align-items: center;
  gap: 6px;
  padding: 6px 12px;
  background: var(--bitbucket-file-accent-purple-light);
  border: 1px solid var(--bitbucket-file-accent-purple-border);
  border-radius: 6px;
  font-size: 13px;
  font-weight: 500;
  color: var(--bitbucket-file-accent-purple);
  cursor: help;
  transition: all 0.2s;
}

.auto-review-badge:hover {
  transform: translateY(-1px);
  box-shadow: 0 2px 4px rgba(147, 51, 234, 0.2);
}

.auto-review-icon {
  width: 16px;
  height: 16px;
  color: var(--bitbucket-file-accent-purple);
}

.sub-info {
  margin-top: 12px;
  display: flex;
  gap: 12px;
  flex-wrap: wrap;
}

.info-badge {
  display: inline-flex;
  align-items: center;
  gap: 6px;
  padding: 6px 12px;
  background: var(--bitbucket-file-bg-tertiary);
  border-radius: 6px;
  font-size: 13px;
  color: var(--bitbucket-file-text-secondary);
  border: 1px solid var(--bitbucket-file-border-primary);
}

.info-badge-label {
  font-weight: 500;
  color: var(--bitbucket-file-text-tertiary);
}

.badge-icon {
  width: 14px;
  height: 14px;
  color: var(--bitbucket-file-text-tertiary);
  flex-shrink: 0;
}

/* Branch Badge */
.branch-badge {
  gap: 8px;
  background: var(--bitbucket-file-accent-blue-light);
  border-color: var(--bitbucket-file-accent-blue-border);
}

.branch-name {
  font-family: 'Monaco', 'Menlo', monospace;
  font-size: 12px;
  font-weight: 600;
  color: var(--bitbucket-file-accent-blue);
  padding: 2px 6px;
  background: var(--bitbucket-file-bg-primary);
  border-radius: 4px;
}

.arrow-icon {
  width: 12px;
  height: 12px;
  color: var(--bitbucket-file-accent-blue);
  flex-shrink: 0;
}

/* View Toggle */
.view-toggle {
  display: flex;
  gap: 8px;
  margin-left: auto;
}

.toggle-btn {
  background-color: var(--bitbucket-file-view-btn-bg);
  color: var(--bitbucket-file-text-primary);
  border: 1px solid var(--bitbucket-file-border-primary);
  padding: 4px 12px;
  border-radius: 4px;
  cursor: pointer;
  font-size: 12px;
  transition: all 0.2s;
}

.toggle-btn:hover {
  background-color: var(--bitbucket-file-view-btn-hover);
}

.toggle-btn.active {
  background-color: var(--bitbucket-file-view-btn-active);
  border-color: var(--bitbucket-file-view-btn-active);
  color: #ffffff;
}

/* Content */
.content {
  flex: 1;
  overflow-y: auto;
  padding: 24px;
  position: relative;
}

.empty-state {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  height: 100%;
  color: var(--bitbucket-file-text-muted);
}

.empty-state-icon {
  width: 48px;
  height: 48px;
  margin-bottom: 12px;
  opacity: 0.5;
}

.content-view {
  opacity: 0;
  transform: translateY(10px);
  transition: opacity 0.3s ease, transform 0.3s ease;
  position: absolute;
  top: 24px;
  left: 24px;
  right: 24px;
  pointer-events: none;
}

.content-view.active {
  opacity: 1;
  transform: translateY(0);
  position: relative;
  top: 0;
  left: 0;
  right: 0;
  pointer-events: all;
}

.content-section {
  margin-bottom: 24px;
}

.section-title {
  font-size: 18px;
  font-weight: 600;
  margin-bottom: 12px;
  color: var(--bitbucket-file-text-primary);
}

.section-content {
  color: var(--bitbucket-file-text-secondary);
  line-height: 1.7;
}

.meta-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: 16px;
  margin-bottom: 24px;
}

.meta-item {
  padding: 16px;
  background: var(--bitbucket-file-bg-secondary);
  border-radius: 8px;
  border: 1px solid var(--bitbucket-file-border-primary);
}

.meta-label {
  font-size: 12px;
  font-weight: 500;
  color: var(--bitbucket-file-text-tertiary);
  text-transform: uppercase;
  letter-spacing: 0.5px;
  margin-bottom: 4px;
}

.meta-value {
  font-size: 16px;
  font-weight: 600;
  color: var(--bitbucket-file-text-primary);
}

/* File Viewer Styles */
.file-viewer-content {
  padding: 0 !important;
}

.file-content-wrapper {
  background-color: var(--bitbucket-file-view-bg-content);
  border: 1px solid var(--bitbucket-file-border-primary);
  border-radius: 8px;
  overflow: hidden;
}

/* Code view with line numbers */
::ng-deep .code-view {
  display: flex;
  font-family: 'Consolas', 'Monaco', 'Courier New', monospace;
  font-size: 13px;
  line-height: 20px;
  background-color: var(--bitbucket-file-view-bg-content);
}

::ng-deep .line-numbers {
  background-color: var(--bitbucket-file-view-bg-content);
  color: var(--bitbucket-file-view-text-line-number);
  padding: 12px 0;
  text-align: right;
  user-select: none;
  min-width: 50px;
  border-right: 1px solid var(--bitbucket-file-border-primary);
  flex-shrink: 0;
}

::ng-deep .line-number {
  padding: 0 12px;
  height: 20px;
  line-height: 20px;
  display: block;
}

::ng-deep .line-number:hover {
  color: var(--bitbucket-file-text-primary);
  cursor: pointer;
}

::ng-deep .code-lines {
  flex: 1;
  padding: 12px 16px;
  overflow-x: auto;
  background-color: var(--bitbucket-file-view-bg-content);
  color: var(--bitbucket-file-text-primary);
}

::ng-deep .code-line {
  height: 20px;
  line-height: 20px;
  display: block;
  white-space: pre;
  font-family: 'Consolas', 'Monaco', 'Courier New', monospace;
  font-size: 13px;
}

/* Markdown view */
::ng-deep .markdown-view {
  padding: 24px 32px;
  background-color: var(--bitbucket-file-view-bg-content);
  color: var(--bitbucket-file-text-primary);
  line-height: 1.6;
}

::ng-deep .markdown-view h1 {
  font-size: 2em;
  border-bottom: 1px solid var(--bitbucket-file-border-primary);
  padding-bottom: 0.3em;
  margin-bottom: 16px;
  margin-top: 24px;
  color: var(--bitbucket-file-text-primary);
}

::ng-deep .markdown-view h1:first-child {
  margin-top: 0;
}

::ng-deep .markdown-view h2 {
  font-size: 1.5em;
  border-bottom: 1px solid var(--bitbucket-file-border-primary);
  padding-bottom: 0.3em;
  margin-bottom: 16px;
  margin-top: 24px;
  color: var(--bitbucket-file-text-primary);
}

::ng-deep .markdown-view h3 {
  font-size: 1.25em;
  margin-bottom: 16px;
  margin-top: 24px;
  color: var(--bitbucket-file-text-primary);
}

::ng-deep .markdown-view h4,
::ng-deep .markdown-view h5,
::ng-deep .markdown-view h6 {
  margin-bottom: 16px;
  margin-top: 24px;
  color: var(--bitbucket-file-text-primary);
}

::ng-deep .markdown-view p {
  margin-bottom: 16px;
}

::ng-deep .markdown-view a {
  color: var(--bitbucket-file-view-link);
  text-decoration: none;
}

::ng-deep .markdown-view a:hover {
  text-decoration: underline;
}

::ng-deep .markdown-view ul,
::ng-deep .markdown-view ol {
  margin-bottom: 16px;
  padding-left: 32px;
}

::ng-deep .markdown-view li {
  margin-bottom: 4px;
}

::ng-deep .markdown-view code {
  background-color: var(--bitbucket-file-view-bg-code-inline);
  padding: 2px 6px;
  border-radius: 3px;
  font-family: 'Consolas', 'Monaco', 'Courier New', monospace;
  font-size: 85%;
  color: var(--bitbucket-file-text-primary);
}

::ng-deep .markdown-view pre {
  background-color: var(--bitbucket-file-view-bg-code-inline);
  padding: 16px;
  border-radius: 6px;
  overflow-x: auto;
  margin-bottom: 16px;
}

::ng-deep .markdown-view pre code {
  background-color: transparent;
  padding: 0;
}

::ng-deep .markdown-view blockquote {
  border-left: 4px solid var(--bitbucket-file-border-primary);
  padding-left: 16px;
  margin-bottom: 16px;
  color: var(--bitbucket-file-view-blockquote);
}

::ng-deep .markdown-view table {
  border-collapse: collapse;
  width: 100%;
  margin-bottom: 16px;
}

::ng-deep .markdown-view table th,
::ng-deep .markdown-view table td {
  border: 1px solid var(--bitbucket-file-border-primary);
  padding: 8px 13px;
}

::ng-deep .markdown-view table th {
  background-color: var(--bitbucket-file-view-bg-code-inline);
  font-weight: 600;
}

::ng-deep .markdown-view table tr:nth-child(even) {
  background-color: var(--bitbucket-file-view-bg-content);
}

::ng-deep .markdown-view img {
  max-width: 100%;
  height: auto;
  margin: 16px 0;
}

::ng-deep .markdown-view hr {
  border: none;
  border-top: 1px solid var(--bitbucket-file-border-primary);
  margin: 24px 0;
}

::ng-deep .markdown-view strong {
  color: var(--bitbucket-file-text-primary);
  font-weight: 600;
}

::ng-deep .markdown-view em {
  font-style: italic;
}

/* Syntax highlighting adjustments */
::ng-deep .hljs {
  background-color: transparent !important;
  color: var(--bitbucket-file-text-primary);
}

@keyframes fadeInUp {
  from {
    opacity: 0;
    transform: translateY(10px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.animate-in {
  animation: fadeInUp 0.4s ease-out;
}

/* Scrollbar Styling for Dark Mode */
[data-theme="dark"] .content::-webkit-scrollbar {
  width: 8px;
}

[data-theme="dark"] .content::-webkit-scrollbar-track {
  background: var(--bitbucket-file-bg-primary);
}

[data-theme="dark"] .content::-webkit-scrollbar-thumb {
  background: var(--bitbucket-file-bg-tertiary);
  border-radius: 4px;
}

[data-theme="dark"] .content::-webkit-scrollbar-thumb:hover {
  background: var(--bitbucket-file-bg-hover);
}

/* Light Mode Scrollbar */
.content::-webkit-scrollbar {
  width: 8px;
}

.content::-webkit-scrollbar-track {
  background: var(--bitbucket-file-bg-secondary);
}

.content::-webkit-scrollbar-thumb {
  background: var(--bitbucket-file-border-secondary);
  border-radius: 4px;
}

.content::-webkit-scrollbar-thumb:hover {
  background: var(--bitbucket-file-text-tertiary);
}

/* Code viewer scrollbar */
::ng-deep .code-lines::-webkit-scrollbar {
  height: 8px;
}

::ng-deep .code-lines::-webkit-scrollbar-track {
  background: var(--bitbucket-file-view-bg-content);
}

::ng-deep .code-lines::-webkit-scrollbar-thumb {
  background: var(--bitbucket-file-border-primary);
  border-radius: 4px;
}

::ng-deep .code-lines::-webkit-scrollbar-thumb:hover {
  background: var(--bitbucket-file-border-secondary);
}
