// /api/imageService.js
export const fetchBulkImages = async (imagePaths = []) => {
  // Simulate actual API call
  await new Promise((res) => setTimeout(res, 500));

  return imagePaths.map((path, index) => ({
    imageName: `Image ${index + 1}`,
    base64Image: `https://picsum.photos/seed/${encodeURIComponent(path)}/300/200`,
  }));
};





import React, { useEffect, useState } from 'react';
import { Dialog } from 'primereact/dialog';
import { Button } from 'primereact/button';
import { fetchBulkImages } from '../api/imageService';
import FullImageScrollModal from './FullImageScrollModal';
import styles from '../styles/ImagePreviewGrid.module.css';

const ImagePreviewGrid = ({ imageList }) => {
  const [imagesToShow, setImagesToShow] = useState([]);
  const [previewImage, setPreviewImage] = useState(null);
  const [showAll, setShowAll] = useState(false);

  const loadFirstTenImages = async () => {
    const firstTenPaths = imageList.slice(0, 10).map(img => img.img_path);
    const result = await fetchBulkImages(firstTenPaths);
    setImagesToShow(result);
  };

  useEffect(() => {
    loadFirstTenImages();
  }, [imageList]);

  const remainingCount = imageList.length - 10;

  return (
    <div>
      <div className={styles.grid}>
        {imagesToShow.map((img, idx) => (
          <img
            key={idx}
            src={img.base64Image}
            alt={img.imageName}
            className={styles.thumb}
            onClick={() => setPreviewImage(img.base64Image)}
          />
        ))}
        {remainingCount > 0 && (
          <Button
            label={`+${remainingCount} More Images`}
            className={`p-button-sm p-button-secondary ${styles.moreButton}`}
            onClick={() => setShowAll(true)}
          />
        )}
      </div>

      <Dialog
        header="Image Preview"
        visible={!!previewImage}
        onHide={() => setPreviewImage(null)}
        style={{ width: '50vw' }}
        modal
      >
        <img src={previewImage} alt="preview" style={{ width: '100%' }} />
      </Dialog>

      <FullImageScrollModal
        visible={showAll}
        onHide={() => setShowAll(false)}
        imageList={imageList}
      />
    </div>
  );
};

export default ImagePreviewGrid;





import React, { useEffect, useState } from 'react';
import { Dialog } from 'primereact/dialog';
import { fetchBulkImages } from '../api/imageService';
import styles from '../styles/FullImageScrollModal.module.css';

const FullImageScrollModal = ({ visible, onHide, imageList }) => {
  const chunkSize = 20;
  const [displayedImages, setDisplayedImages] = useState([]);
  const [nextIndex, setNextIndex] = useState(10); // start from 10 (already shown)

  const loadNextChunk = async () => {
    const nextPaths = imageList
      .slice(nextIndex, nextIndex + chunkSize)
      .map(img => img.img_path);

    if (nextPaths.length === 0) return;

    const result = await fetchBulkImages(nextPaths);
    setDisplayedImages(prev => [...prev, ...result]);
    setNextIndex(prev => prev + chunkSize);
  };

  useEffect(() => {
    if (visible) {
      setDisplayedImages([]);
      setNextIndex(10); // reset to 10 (skip first 10)
    }
  }, [visible]);

  useEffect(() => {
    if (visible && displayedImages.length === 0) {
      loadNextChunk(); // load first chunk inside modal
    }
  }, [visible, displayedImages]);

  const handleScroll = (e) => {
    const { scrollTop, scrollHeight, clientHeight } = e.target;
    if (scrollTop + clientHeight >= scrollHeight - 20) {
      loadNextChunk();
    }
  };

  return (
    <Dialog
      header="All Images"
      visible={visible}
      onHide={onHide}
      modal
      style={{ width: '70vw', maxHeight: '80vh' }}
    >
      <div className={styles.scrollContainer} onScroll={handleScroll}>
        <div className={styles.grid}>
          {displayedImages.map((img, idx) => (
            <img
              key={idx}
              src={img.base64Image}
              alt={img.imageName}
              className={styles.thumb}
            />
          ))}
        </div>
        {nextIndex < imageList.length && (
          <p className={styles.loading}>Loading more images...</p>
        )}
      </div>
    </Dialog>
  );
};

export default FullImageScrollModal;









.grid {
  display: flex;
  flex-wrap: wrap;
  gap: 10px;
  align-items: center;
}

.thumb {
  width: 120px;
  height: 80px;
  object-fit: cover;
  border-radius: 8px;
  cursor: pointer;
}

.moreButton {
  height: 80px;
  min-width: 120px;
  border-radius: 8px;
  display: flex;
  align-items: center;
  justify-content: center;
}









.scrollContainer {
  height: 60vh;
  overflow-y: auto;
  padding: 10px;
}

.grid {
  display: flex;
  flex-wrap: wrap;
  gap: 10px;
}

.thumb {
  width: 140px;
  height: 100px;
  object-fit: cover;
  border-radius: 6px;
}

.loading {
  text-align: center;
  margin-top: 10px;
  font-style: italic;
  color: gray;
}







