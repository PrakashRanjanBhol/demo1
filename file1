<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI UI Mockup Generator</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fabric.js/5.3.0/fabric.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 12px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .header p {
            font-size: 1.1em;
            opacity: 0.9;
        }

        .content {
            display: grid;
            grid-template-columns: 400px 1fr;
            gap: 0;
            min-height: 600px;
        }

        .control-panel {
            background: #f8f9fa;
            padding: 30px;
            border-right: 1px solid #e0e0e0;
        }

        .api-key-section {
            margin-bottom: 25px;
        }

        .api-key-section label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #333;
        }

        .api-key-section input {
            width: 100%;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 6px;
            font-size: 14px;
            transition: border-color 0.3s;
        }

        .api-key-section input:focus {
            outline: none;
            border-color: #667eea;
        }

        .description-section {
            margin-bottom: 25px;
        }

        .description-section label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #333;
        }

        .description-section textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 6px;
            font-size: 14px;
            resize: vertical;
            min-height: 120px;
            font-family: inherit;
            transition: border-color 0.3s;
        }

        .description-section textarea:focus {
            outline: none;
            border-color: #667eea;
        }

        .button-group {
            display: flex;
            gap: 10px;
            margin-bottom: 25px;
        }

        button {
            flex: 1;
            padding: 14px 20px;
            border: none;
            border-radius: 6px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }

        .generate-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .generate-btn:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        .generate-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

        .clear-btn {
            background: #e0e0e0;
            color: #333;
        }

        .clear-btn:hover {
            background: #d0d0d0;
        }

        .export-btn {
            background: #4caf50;
            color: white;
        }

        .export-btn:hover {
            background: #45a049;
        }

        .examples {
            background: white;
            padding: 20px;
            border-radius: 8px;
            border: 1px solid #e0e0e0;
        }

        .examples h3 {
            margin-bottom: 12px;
            color: #333;
            font-size: 16px;
        }

        .example-item {
            padding: 10px;
            margin-bottom: 8px;
            background: #f8f9fa;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.2s;
            font-size: 14px;
            color: #555;
        }

        .example-item:hover {
            background: #667eea;
            color: white;
            transform: translateX(5px);
        }

        .canvas-container-wrapper {
            padding: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: #fafafa;
        }

        #canvas {
            border: 2px solid #ddd;
            border-radius: 8px;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.1);
            background: white;
        }

        .status {
            padding: 12px;
            margin-bottom: 20px;
            border-radius: 6px;
            text-align: center;
            font-weight: 500;
            display: none;
        }

        .status.loading {
            display: block;
            background: #fff3cd;
            color: #856404;
        }

        .status.success {
            display: block;
            background: #d4edda;
            color: #155724;
        }

        .status.error {
            display: block;
            background: #f8d7da;
            color: #721c24;
        }

        .loader {
            display: inline-block;
            width: 16px;
            height: 16px;
            border: 3px solid #f3f3f3;
            border-top: 3px solid #667eea;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-right: 8px;
            vertical-align: middle;
        }

        @keyframes spin {
            0% {
                transform: rotate(0deg);
            }

            100% {
                transform: rotate(360deg);
            }
        }

        @media (max-width: 1024px) {
            .content {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>

<body>
    <div class="container">
        <div class="header">
            <h1>ðŸŽ¨ AI UI Mockup Generator</h1>
            <p>Describe your UI in natural language and watch it come to life</p>
        </div>

        <div class="content">
            <div class="control-panel">
                <div class="api-key-section">
                    <label for="apiKey">OpenAI API Key:</label>
                    <input type="password" id="apiKey" placeholder="sk-..." autocomplete="off">
                </div>

                <div class="status" id="status"></div>

                <div class="description-section">
                    <label for="uiDescription">Describe Your UI:</label>
                    <textarea id="uiDescription"
                        placeholder="Example: Design a login page with two text fields for username and password, and a blue login button below them"></textarea>
                </div>

                <div class="button-group">
                    <button class="generate-btn" id="generateBtn">
                        Generate UI
                    </button>
                    <button class="clear-btn" id="clearBtn">
                        Clear Canvas
                    </button>
                </div>

                <button class="export-btn" id="exportBtn" style="width: 100%; margin-bottom: 25px;">
                    Export as PNG
                </button>

                <div class="examples">
                    <h3>ðŸ“‹ Example Prompts:</h3>
                    <div class="example-item"
                        data-example="Design a login page with two text fields for username and password, and a blue login button below them">
                        Login Form
                    </div>
                    <div class="example-item"
                        data-example="Create a dashboard header with a logo on the left, search bar in the center, and profile icon on the right">
                        Dashboard Header
                    </div>
                    <div class="example-item"
                        data-example="Design a card component with an image at the top, title, description text, and two action buttons at the bottom">
                        Card Component
                    </div>
                    <div class="example-item"
                        data-example="Create a settings page with a sidebar menu on the left and content area on the right with toggle switches">
                        Settings Page
                    </div>
                    <div class="example-item"
                        data-example="Design a mobile app home screen with a header, grid of 6 colorful icon buttons, and a bottom navigation bar">
                        Mobile Home Screen
                    </div>
                </div>
            </div>

            <div class="canvas-container-wrapper">
                <canvas id="canvas" width="800" height="600"></canvas>
            </div>
        </div>
    </div>

    <script>
        // Initialize Fabric.js canvas
        const canvas = new fabric.Canvas('canvas', {
            backgroundColor: '#ffffff'
        });

        // DOM elements
        const apiKeyInput = document.getElementById('apiKey');
        const uiDescriptionInput = document.getElementById('uiDescription');
        const generateBtn = document.getElementById('generateBtn');
        const clearBtn = document.getElementById('clearBtn');
        const exportBtn = document.getElementById('exportBtn');
        const statusDiv = document.getElementById('status');
        const exampleItems = document.querySelectorAll('.example-item');

        // Load API key from localStorage
        const savedApiKey = localStorage.getItem('openai_api_key');
        if (savedApiKey) {
            apiKeyInput.value = savedApiKey;
        }

        // Save API key to localStorage on change
        apiKeyInput.addEventListener('change', () => {
            localStorage.setItem('openai_api_key', apiKeyInput.value);
        });

        // Example click handlers
        exampleItems.forEach(item => {
            item.addEventListener('click', () => {
                uiDescriptionInput.value = item.dataset.example;
            });
        });

        // Show status message
        function showStatus(message, type) {
            statusDiv.className = `status ${type}`;
            if (type === 'loading') {
                statusDiv.innerHTML = `<span class="loader"></span>${message}`;
            } else {
                statusDiv.textContent = message;
            }

            if (type !== 'loading') {
                setTimeout(() => {
                    statusDiv.style.display = 'none';
                }, 5000);
            }
        }

        // Clear canvas
        clearBtn.addEventListener('click', () => {
            canvas.clear();
            canvas.backgroundColor = '#ffffff';
            canvas.renderAll();
        });

        // Export canvas as PNG
        exportBtn.addEventListener('click', () => {
            const dataURL = canvas.toDataURL({
                format: 'png',
                quality: 1
            });
            const link = document.createElement('a');
            link.download = 'ui-mockup.png';
            link.href = dataURL;
            link.click();
            showStatus('Mockup exported successfully!', 'success');
        });

        // Generate UI mockup
        generateBtn.addEventListener('click', async () => {
            const apiKey = apiKeyInput.value.trim();
            const description = uiDescriptionInput.value.trim();

            if (!apiKey) {
                showStatus('Please enter your OpenAI API key', 'error');
                return;
            }

            if (!description) {
                showStatus('Please describe the UI you want to create', 'error');
                return;
            }

            generateBtn.disabled = true;
            showStatus('Generating UI mockup...', 'loading');

            try {
                const layoutData = await getLayoutFromOpenAI(apiKey, description);
                renderMockup(layoutData);
                showStatus('UI mockup generated successfully!', 'success');
            } catch (error) {
                console.error('Error:', error);
                showStatus(`Error: ${error.message}`, 'error');
            } finally {
                generateBtn.disabled = false;
            }
        });

        // Call OpenAI API to get layout data
        async function getLayoutFromOpenAI(apiKey, description) {
            const prompt = `You are a UI/UX designer. Convert the following UI description into a JSON layout specification for Fabric.js rendering.

Description: ${description}

Return ONLY a valid JSON object with this structure:
{
  "elements": [
    {
      "type": "rectangle" | "text" | "circle" | "button" | "textbox",
      "x": number,
      "y": number,
      "width": number,
      "height": number,
      "fill": "color",
      "text": "text content (if applicable)",
      "fontSize": number (if applicable),
      "rx": number (border radius, if applicable),
      "ry": number (border radius, if applicable)
    }
  ]
}

Guidelines:
- Canvas is 800x600
- Use common UI colors (blues, grays, whites)
- For buttons: use rectangles with rx/ry for rounded corners
- For text fields: use rectangles with light gray fill and placeholder text
- For labels: use text elements
- Position elements with proper spacing
- Make the layout clean and professional

Return ONLY the JSON, no other text.`;

            const response = await fetch('https://api.openai.com/v1/chat/completions', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'Authorization': `Bearer ${apiKey}`
                },
                body: JSON.stringify({
                    model: 'gpt-4o-mini',
                    messages: [
                        {
                            role: 'system',
                            content: 'You are a helpful UI/UX designer that converts natural language descriptions into JSON layout specifications.'
                        },
                        {
                            role: 'user',
                            content: prompt
                        }
                    ],
                    temperature: 0.7,
                    max_tokens: 2000
                })
            });

            if (!response.ok) {
                const errorData = await response.json();
                throw new Error(errorData.error?.message || 'Failed to generate layout');
            }

            const data = await response.json();
            const content = data.choices[0].message.content.trim();

            // Extract JSON from response (in case there's extra text)
            const jsonMatch = content.match(/\{[\s\S]*\}/);
            if (!jsonMatch) {
                throw new Error('Invalid response format from OpenAI');
            }

            return JSON.parse(jsonMatch[0]);
        }

        // Render mockup on canvas
        function renderMockup(layoutData) {
            canvas.clear();
            canvas.backgroundColor = '#ffffff';

            layoutData.elements.forEach(element => {
                let fabricObject;

                switch (element.type) {
                    case 'rectangle':
                        fabricObject = new fabric.Rect({
                            left: element.x,
                            top: element.y,
                            width: element.width,
                            height: element.height,
                            fill: element.fill || '#e0e0e0',
                            rx: element.rx || 0,
                            ry: element.ry || 0,
                            stroke: element.stroke || '#cccccc',
                            strokeWidth: element.strokeWidth || 1
                        });
                        break;

                    case 'text':
                        fabricObject = new fabric.Text(element.text || 'Text', {
                            left: element.x,
                            top: element.y,
                            fontSize: element.fontSize || 16,
                            fill: element.fill || '#000000',
                            fontFamily: element.fontFamily || 'Arial'
                        });
                        break;

                    case 'textbox':
                        fabricObject = new fabric.Textbox(element.text || 'Text Box', {
                            left: element.x,
                            top: element.y,
                            width: element.width || 200,
                            fontSize: element.fontSize || 14,
                            fill: element.fill || '#666666',
                            fontFamily: element.fontFamily || 'Arial'
                        });
                        break;

                    case 'circle':
                        fabricObject = new fabric.Circle({
                            left: element.x,
                            top: element.y,
                            radius: element.radius || 30,
                            fill: element.fill || '#4CAF50',
                            stroke: element.stroke || '#cccccc',
                            strokeWidth: element.strokeWidth || 1
                        });
                        break;

                    case 'button':
                        // Button as a group (rectangle + text)
                        const buttonRect = new fabric.Rect({
                            width: element.width,
                            height: element.height,
                            fill: element.fill || '#2196F3',
                            rx: element.rx || 5,
                            ry: element.ry || 5
                        });

                        const buttonText = new fabric.Text(element.text || 'Button', {
                            fontSize: element.fontSize || 16,
                            fill: '#ffffff',
                            fontFamily: 'Arial'
                        });

                        fabricObject = new fabric.Group([buttonRect, buttonText], {
                            left: element.x,
                            top: element.y
                        });
                        break;
                }

                if (fabricObject) {
                    canvas.add(fabricObject);
                }
            });

            canvas.renderAll();
        }
    </script>
</body>

</html>
