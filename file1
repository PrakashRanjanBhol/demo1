/* CSS Variables for Theming */
:host {
    /* Light Theme (Default) */
    --bitbucket-file-comparator-bg-primary: #ffffff;
    --bitbucket-file-comparator-bg-secondary: #f5f5f5;
    --bitbucket-file-comparator-bg-tertiary: #fafbfc;
    --bitbucket-file-comparator-bg-overlay: #f0f7ff;
    
    --bitbucket-file-comparator-text-primary: #24292e;
    --bitbucket-file-comparator-text-secondary: #6c757d;
    --bitbucket-file-comparator-text-tertiary: #57606a;
    
    --bitbucket-file-comparator-border-primary: #e1e4e8;
    --bitbucket-file-comparator-border-secondary: #d0d7de;
    --bitbucket-file-comparator-border-tertiary: #d1d5db;
    
    --bitbucket-file-comparator-accent-primary: #0052cc;
    --bitbucket-file-comparator-accent-secondary: #0065ff;
    
    --bitbucket-file-comparator-comment-bg: #ffffff;
    --bitbucket-file-comparator-comment-border: #e0d4ff;
    --bitbucket-file-comparator-comment-shadow: rgba(0, 0, 0, 0.08);
    
    --bitbucket-file-comparator-success-bg: #f0fdf4;
    --bitbucket-file-comparator-success-border: #86efac;
    --bitbucket-file-comparator-success-text: #166534;
    --bitbucket-file-comparator-success-bg-light: #dcfce7;
    
    --bitbucket-file-comparator-error-bg: #fef2f2;
    --bitbucket-file-comparator-error-border: #fca5a5;
    --bitbucket-file-comparator-error-text: #991b1b;
    --bitbucket-file-comparator-error-bg-light: #fee2e2;
    
    --bitbucket-file-comparator-warning-bg: #fef3c7;
    --bitbucket-file-comparator-warning-text: #92400e;
    
    --bitbucket-file-comparator-info-bg: #dbeafe;
    --bitbucket-file-comparator-info-text: #1e40af;
    
    --bitbucket-file-comparator-purple-bg: #f3e8ff;
    --bitbucket-file-comparator-purple-text: #7c3aed;
    --bitbucket-file-comparator-purple-border: #7c3aed;
    
    --bitbucket-file-comparator-highlight-comment: #faf5ff;
    --bitbucket-file-comparator-highlight-accepted: #f0fdf4;
    --bitbucket-file-comparator-highlight-rejected: #fef2f2;
    
    --bitbucket-file-comparator-spinner-bg: #f3f4f6;
    --bitbucket-file-comparator-spinner-border: #e5e7eb;
    --bitbucket-file-comparator-spinner-accent: #7c3aed;
    
    --bitbucket-file-comparator-code-bg: #f6f8fa;
    --bitbucket-file-comparator-code-text: #24292e;
    
    /* Diff colors - Light theme */
    --bitbucket-file-comparator-diff-deletion-bg: rgba(220, 38, 38, 0.15);
    --bitbucket-file-comparator-diff-deletion-line-bg: rgba(220, 38, 38, 0.2);
    --bitbucket-file-comparator-diff-deletion-border: rgba(220, 38, 38, 0.3);
    --bitbucket-file-comparator-diff-deletion-change: rgba(220, 38, 38, 0.4);
    
    --bitbucket-file-comparator-diff-insertion-bg: rgba(34, 197, 94, 0.15);
    --bitbucket-file-comparator-diff-insertion-line-bg: rgba(34, 197, 94, 0.2);
    --bitbucket-file-comparator-diff-insertion-border: rgba(34, 197, 94, 0.3);
    --bitbucket-file-comparator-diff-insertion-change: rgba(34, 197, 94, 0.4);
    
    /* Syntax highlighting - Light theme */
    --bitbucket-file-comparator-syntax-keyword: #d73a49;
    --bitbucket-file-comparator-syntax-string: #032f62;
    --bitbucket-file-comparator-syntax-number: #005cc5;
    --bitbucket-file-comparator-syntax-comment: #6a737d;
    --bitbucket-file-comparator-syntax-function: #6f42c1;
    --bitbucket-file-comparator-syntax-variable: #e36209;
    --bitbucket-file-comparator-syntax-class: #22863a;
    --bitbucket-file-comparator-syntax-tag: #22863a;
    --bitbucket-file-comparator-syntax-attribute: #6f42c1;
    --bitbucket-file-comparator-syntax-operator: #d73a49;
}

/* Dark Theme */
:host-context(.dark-theme),
:host.dark-theme {
    --bitbucket-file-comparator-bg-primary: #0a0a0b;
    --bitbucket-file-comparator-bg-secondary: #161618;
    --bitbucket-file-comparator-bg-tertiary: #1e1e20;
    --bitbucket-file-comparator-bg-overlay: #1a1d2e;
    
    --bitbucket-file-comparator-text-primary: #e6e6e6;
    --bitbucket-file-comparator-text-secondary: #9ca3af;
    --bitbucket-file-comparator-text-tertiary: #6b7280;
    
    --bitbucket-file-comparator-border-primary: #2d2d30;
    --bitbucket-file-comparator-border-secondary: #3d3d40;
    --bitbucket-file-comparator-border-tertiary: #4d4d50;
    
    --bitbucket-file-comparator-accent-primary: #3b82f6;
    --bitbucket-file-comparator-accent-secondary: #60a5fa;
    
    --bitbucket-file-comparator-comment-bg: #1e1e20;
    --bitbucket-file-comparator-comment-border: #4c1d95;
    --bitbucket-file-comparator-comment-shadow: rgba(0, 0, 0, 0.3);
    
    --bitbucket-file-comparator-success-bg: #14532d;
    --bitbucket-file-comparator-success-border: #16a34a;
    --bitbucket-file-comparator-success-text: #86efac;
    --bitbucket-file-comparator-success-bg-light: #166534;
    
    --bitbucket-file-comparator-error-bg: #450a0a;
    --bitbucket-file-comparator-error-border: #dc2626;
    --bitbucket-file-comparator-error-text: #fca5a5;
    --bitbucket-file-comparator-error-bg-light: #991b1b;
    
    --bitbucket-file-comparator-warning-bg: #451a03;
    --bitbucket-file-comparator-warning-text: #fbbf24;
    
    --bitbucket-file-comparator-info-bg: #1e3a8a;
    --bitbucket-file-comparator-info-text: #93c5fd;
    
    --bitbucket-file-comparator-purple-bg: #2e1065;
    --bitbucket-file-comparator-purple-text: #a78bfa;
    --bitbucket-file-comparator-purple-border: #7c3aed;
    
    --bitbucket-file-comparator-highlight-comment: #2e1065;
    --bitbucket-file-comparator-highlight-accepted: #14532d;
    --bitbucket-file-comparator-highlight-rejected: #450a0a;
    
    --bitbucket-file-comparator-spinner-bg: #2d2d30;
    --bitbucket-file-comparator-spinner-border: #3d3d40;
    --bitbucket-file-comparator-spinner-accent: #a78bfa;
    
    --bitbucket-file-comparator-code-bg: #1e1e20;
    --bitbucket-file-comparator-code-text: #e6e6e6;
    
    /* Diff colors - Dark theme */
    --bitbucket-file-comparator-diff-deletion-bg: rgba(220, 38, 38, 0.2);
    --bitbucket-file-comparator-diff-deletion-line-bg: rgba(220, 38, 38, 0.25);
    --bitbucket-file-comparator-diff-deletion-border: rgba(220, 38, 38, 0.35);
    --bitbucket-file-comparator-diff-deletion-change: rgba(220, 38, 38, 0.5);
    
    --bitbucket-file-comparator-diff-insertion-bg: rgba(34, 197, 94, 0.2);
    --bitbucket-file-comparator-diff-insertion-line-bg: rgba(34, 197, 94, 0.25);
    --bitbucket-file-comparator-diff-insertion-border: rgba(34, 197, 94, 0.35);
    --bitbucket-file-comparator-diff-insertion-change: rgba(34, 197, 94, 0.5);
    
    /* Syntax highlighting - Dark theme (Material Theme Palenight) */
    --bitbucket-file-comparator-syntax-keyword: #c792ea;
    --bitbucket-file-comparator-syntax-string: #c3e88d;
    --bitbucket-file-comparator-syntax-number: #f78c6c;
    --bitbucket-file-comparator-syntax-comment: #676e95;
    --bitbucket-file-comparator-syntax-function: #82aaff;
    --bitbucket-file-comparator-syntax-variable: #f07178;
    --bitbucket-file-comparator-syntax-class: #ffcb6b;
    --bitbucket-file-comparator-syntax-tag: #f07178;
    --bitbucket-file-comparator-syntax-attribute: #c792ea;
    --bitbucket-file-comparator-syntax-operator: #89ddff;
}














/* Diff2Html Theme Support with parent container */
.pr-review-container ::ng-deep .d2h-wrapper,
.pr-review-container ::ng-deep .d2h-diff-table {
    background-color: var(--bitbucket-file-comparator-bg-primary) !important;
    color: var(--bitbucket-file-comparator-text-primary) !important;
}

/* Line numbers */
.pr-review-container ::ng-deep .d2h-code-linenumber,
.pr-review-container ::ng-deep .d2h-code-side-linenumber {
    background-color: var(--bitbucket-file-comparator-bg-tertiary) !important;
    border-color: var(--bitbucket-file-comparator-border-primary) !important;
    color: var(--bitbucket-file-comparator-text-secondary) !important;
}

/* Code lines */
.pr-review-container ::ng-deep .d2h-code-line,
.pr-review-container ::ng-deep .d2h-code-side-line {
    background-color: var(--bitbucket-file-comparator-bg-primary) !important;
    color: var(--bitbucket-file-comparator-text-primary) !important;
}

/* Empty cells in side-by-side */
.pr-review-container ::ng-deep .d2h-code-side-emptyplaceholder {
    background-color: var(--bitbucket-file-comparator-bg-tertiary) !important;
    border-color: var(--bitbucket-file-comparator-border-primary) !important;
}

/* Deletions (removed lines) */
.pr-review-container ::ng-deep .d2h-del,
.pr-review-container ::ng-deep .d2h-code-line.d2h-del,
.pr-review-container ::ng-deep .d2h-code-side-line.d2h-del {
    background-color: var(--bitbucket-file-comparator-diff-deletion-bg) !important;
}

.pr-review-container ::ng-deep .d2h-code-linenumber.d2h-del,
.pr-review-container ::ng-deep .d2h-code-side-linenumber.d2h-del {
    background-color: var(--bitbucket-file-comparator-diff-deletion-line-bg) !important;
    border-color: var(--bitbucket-file-comparator-diff-deletion-border) !important;
}

/* Insertions (added lines) */
.pr-review-container ::ng-deep .d2h-ins,
.pr-review-container ::ng-deep .d2h-code-line.d2h-ins,
.pr-review-container ::ng-deep .d2h-code-side-line.d2h-ins {
    background-color: var(--bitbucket-file-comparator-diff-insertion-bg) !important;
}

.pr-review-container ::ng-deep .d2h-code-linenumber.d2h-ins,
.pr-review-container ::ng-deep .d2h-code-side-linenumber.d2h-ins {
    background-color: var(--bitbucket-file-comparator-diff-insertion-line-bg) !important;
    border-color: var(--bitbucket-file-comparator-diff-insertion-border) !important;
}

/* Changed text highlighting within lines */
.pr-review-container ::ng-deep .d2h-del .d2h-change {
    background-color: var(--bitbucket-file-comparator-diff-deletion-change) !important;
}

.pr-review-container ::ng-deep .d2h-ins .d2h-change {
    background-color: var(--bitbucket-file-comparator-diff-insertion-change) !important;
}

/* Info section (file headers, hunks) */
.pr-review-container ::ng-deep .d2h-info {
    background-color: var(--bitbucket-file-comparator-bg-tertiary) !important;
    color: var(--bitbucket-file-comparator-accent-primary) !important;
    border-color: var(--bitbucket-file-comparator-border-primary) !important;
}

/* File wrapper */
.pr-review-container ::ng-deep .d2h-file-wrapper {
    border-color: var(--bitbucket-file-comparator-border-primary) !important;
}

/* Diff tbody */
.pr-review-container ::ng-deep .d2h-diff-tbody {
    background-color: var(--bitbucket-file-comparator-bg-primary) !important;
}

/* Table borders */
.pr-review-container ::ng-deep .d2h-diff-table tr,
.pr-review-container ::ng-deep .d2h-diff-table td {
    border-color: var(--bitbucket-file-comparator-border-primary) !important;
}

/* Code line content */
.pr-review-container ::ng-deep .d2h-code-line-ctn,
.pr-review-container ::ng-deep .d2h-code-side-line-ctn {
    color: var(--bitbucket-file-comparator-text-primary) !important;
}

/* Syntax highlighting - Override ALL hljs styles */
.pr-review-container ::ng-deep .d2h-code-line-ctn .hljs,
.pr-review-container ::ng-deep .d2h-code-side-line-ctn .hljs,
.pr-review-container ::ng-deep .hljs {
    background-color: transparent !important;
    color: var(--bitbucket-file-comparator-text-primary) !important;
}

/* Reset all default hljs colors first */
.pr-review-container ::ng-deep .hljs-keyword,
.pr-review-container ::ng-deep .hljs-selector-tag,
.pr-review-container ::ng-deep .hljs-literal,
.pr-review-container ::ng-deep .hljs-section,
.pr-review-container ::ng-deep .hljs-link {
    color: var(--bitbucket-file-comparator-syntax-keyword) !important;
    font-weight: normal !important;
}

.pr-review-container ::ng-deep .hljs-string,
.pr-review-container ::ng-deep .hljs-doctag,
.pr-review-container ::ng-deep .hljs-title,
.pr-review-container ::ng-deep .hljs-section,
.pr-review-container ::ng-deep .hljs-type,
.pr-review-container ::ng-deep .hljs-selector-id {
    color: var(--bitbucket-file-comparator-syntax-string) !important;
}

.pr-review-container ::ng-deep .hljs-number,
.pr-review-container ::ng-deep .hljs-attr,
.pr-review-container ::ng-deep .hljs-symbol,
.pr-review-container ::ng-deep .hljs-bullet,
.pr-review-container ::ng-deep .hljs-meta {
    color: var(--bitbucket-file-comparator-syntax-number) !important;
}

.pr-review-container ::ng-deep .hljs-comment,
.pr-review-container ::ng-deep .hljs-quote,
.pr-review-container ::ng-deep .hljs-deletion {
    color: var(--bitbucket-file-comparator-syntax-comment) !important;
    font-style: italic !important;
}

.pr-review-container ::ng-deep .hljs-function,
.pr-review-container ::ng-deep .hljs-title.function_,
.pr-review-container ::ng-deep .hljs-title.class_,
.pr-review-container ::ng-deep .hljs-built_in {
    color: var(--bitbucket-file-comparator-syntax-function) !important;
}

.pr-review-container ::ng-deep .hljs-variable,
.pr-review-container ::ng-deep .hljs-template-variable,
.pr-review-container ::ng-deep .hljs-variable.language_,
.pr-review-container ::ng-deep .hljs-variable.constant_ {
    color: var(--bitbucket-file-comparator-syntax-variable) !important;
}

.pr-review-container ::ng-deep .hljs-class,
.pr-review-container ::ng-deep .hljs-type,
.pr-review-container ::ng-deep .hljs-title.class_,
.pr-review-container ::ng-deep .hljs-title.class_.inherited__,
.pr-review-container ::ng-deep .hljs-name {
    color: var(--bitbucket-file-comparator-syntax-class) !important;
}

.pr-review-container ::ng-deep .hljs-tag,
.pr-review-container ::ng-deep .hljs-name {
    color: var(--bitbucket-file-comparator-syntax-tag) !important;
}

.pr-review-container ::ng-deep .hljs-attribute,
.pr-review-container ::ng-deep .hljs-property,
.pr-review-container ::ng-deep .hljs-params {
    color: var(--bitbucket-file-comparator-syntax-attribute) !important;
}

.pr-review-container ::ng-deep .hljs-operator,
.pr-review-container ::ng-deep .hljs-built_in,
.pr-review-container ::ng-deep .hljs-selector-class,
.pr-review-container ::ng-deep .hljs-selector-pseudo,
.pr-review-container ::ng-deep .hljs-punctuation {
    color: var(--bitbucket-file-comparator-syntax-operator) !important;
}

/* Additional hljs elements */
.pr-review-container ::ng-deep .hljs-regexp,
.pr-review-container ::ng-deep .hljs-subst {
    color: var(--bitbucket-file-comparator-text-primary) !important;
}

.pr-review-container ::ng-deep .hljs-emphasis {
    font-style: italic !important;
}

.pr-review-container ::ng-deep .hljs-strong {
    font-weight: bold !important;
}

/* Side-by-side specific adjustments */
.pr-review-container ::ng-deep .d2h-file-side-diff {
    background-color: var(--bitbucket-file-comparator-bg-primary) !important;
}

/* Context lines (unchanged) in side-by-side */
.pr-review-container ::ng-deep .d2h-cntx,
.pr-review-container ::ng-deep .d2h-code-side-line.d2h-cntx {
    background-color: var(--bitbucket-file-comparator-bg-primary) !important;
}

/* Deleted in side-by-side left column */
.pr-review-container ::ng-deep .d2h-file-side-diff .d2h-del.d2h-change {
    background-color: var(--bitbucket-file-comparator-diff-deletion-change) !important;
}

/* Added in side-by-side right column */
.pr-review-container ::ng-deep .d2h-file-side-diff .d2h-ins.d2h-change {
    background-color: var(--bitbucket-file-comparator-diff-insertion-change) !important;
}

/* Modified line highlighting adjustments */
.pr-review-container ::ng-deep .has-ai-comment {
    background-color: var(--bitbucket-file-comparator-highlight-comment) !important;
}

.pr-review-container ::ng-deep .has-ai-comment-accepted {
    background-color: var(--bitbucket-file-comparator-highlight-accepted) !important;
}

.pr-review-container ::ng-deep .has-ai-comment-rejected {
    background-color: var(--bitbucket-file-comparator-highlight-rejected) !important;
}

/* Scrollbar */
.pr-review-container ::ng-deep .d2h-wrapper::-webkit-scrollbar {
    width: 10px;
    height: 10px;
}

.pr-review-container ::ng-deep .d2h-wrapper::-webkit-scrollbar-track {
    background: var(--bitbucket-file-comparator-bg-tertiary);
}

.pr-review-container ::ng-deep .d2h-wrapper::-webkit-scrollbar-thumb {
    background: var(--bitbucket-file-comparator-border-secondary);
    border-radius: 5px;
}

.pr-review-container ::ng-deep .d2h-wrapper::-webkit-scrollbar-thumb:hover {
    background: var(--bitbucket-file-comparator-text-secondary);
}
