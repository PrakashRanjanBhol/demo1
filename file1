addToolFromStream(input: string): void {
  const tools = this.parseToolString(input);
  
  if (tools.length === 0) return;

  // Filter out WRITE/MODIFY tools with empty files array
  const validTools = tools.filter(tool => {
    if (tool.tool === 'WRITE' || tool.tool === 'MODIFY') {
      const content = tool.content as WriteModifyContent;
      
      // Check if files array exists and is not empty
      if (!content.files || content.files.length === 0) {
        console.warn(`Ignoring ${tool.tool} tool with empty files array:`, tool);
        return false;
      }
    }
    return true;
  });

  if (validTools.length === 0) return;

  this.processingQueue.push(...validTools);
  
  if (!this.isProcessing && !this.waitingForApproval) {
    this.processQueue();
  }
}
