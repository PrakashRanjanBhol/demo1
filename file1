PrimeNG 16 Context Menu - Modified Parts Only
üîÑ Changes for PrimeNG 16
PrimeNG 16 has slightly different imports and API. Here are ONLY the modified parts:

üìù FILE 1: repository-sidebar.component.ts
MODIFY: Import Section (Lines 1-3)
typescript// ‚úÖ REPLACE THIS
import { Component, OnInit, ViewChild } from '@angular/core';
import { ContextMenu } from 'primeng/contextmenu';
import { MenuItem } from 'primeng/api';
MODIFY: Properties Section (Lines ~120-123)
typescript// ‚úÖ ADD THESE PROPERTIES
// PrimeNG Context Menu
@ViewChild('cm') contextMenu!: ContextMenu;
contextMenuItems: MenuItem[] = [];
selectedFileName: string | null = null;
MODIFY: ngOnInit Method (Lines ~125-140)
typescript// ‚úÖ REPLACE/ADD IN ngOnInit
ngOnInit(): void {
  // Initialize PrimeNG context menu items
  this.contextMenuItems = [
    {
      label: 'Summarize File',
      icon: 'pi pi-file',
      command: () => this.summarizeFile()
    },
    {
      label: 'Open File',
      icon: 'pi pi-external-link',
      command: () => this.openFile()
    },
    {
      separator: true
    },
    {
      label: 'Copy Path',
      icon: 'pi pi-copy',
      command: () => this.copyFilePath()
    }
  ];
}
MODIFY: Context Menu Handler (Lines ~250-256)
typescript// ‚úÖ ADD THIS NEW METHOD (replaces handleFileRightClick)
onFileRightClick(event: MouseEvent, fileName: string): void {
  this.selectedFileName = fileName;
  if (this.contextMenu) {
    this.contextMenu.show(event);
  }
  event.preventDefault();
  event.stopPropagation();
}
MODIFY: Context Menu Actions (Lines ~260-285)
typescript// ‚úÖ UPDATE summarizeFile METHOD
summarizeFile(): void {
  if (this.selectedFileName) {
    const relativePath = [...this.currentPath.slice(1), this.selectedFileName].join('/');
    alert('Summarizing file: ' + relativePath);
  }
  this.selectedFileName = null;
}

// ‚úÖ ADD THIS NEW METHOD
openFile(): void {
  if (this.selectedFileName) {
    const relativePath = [...this.currentPath.slice(1), this.selectedFileName].join('/');
    alert('Opening file: ' + relativePath);
  }
  this.selectedFileName = null;
}

// ‚úÖ ADD THIS NEW METHOD
copyFilePath(): void {
  if (this.selectedFileName) {
    const relativePath = [...this.currentPath.slice(1), this.selectedFileName].join('/');
    navigator.clipboard.writeText(relativePath).then(() => {
      alert('Path copied to clipboard: ' + relativePath);
    });
  }
  this.selectedFileName = null;
}
‚ùå REMOVE THESE METHODS AND HOST LISTENERS:
typescript// ‚ùå REMOVE THESE (~30 lines around line 250-280)
handleFileRightClick(event: MouseEvent, fileName: string): void {
  event.preventDefault();
  event.stopPropagation();
  this.contextMenuFileName = fileName;
  this.contextMenuVisible = true;
  this.contextMenuX = event.pageX;
  this.contextMenuY = event.pageY;
}

hideContextMenu(): void {
  this.contextMenuVisible = false;
  this.contextMenuFileName = null;
}

@HostListener('document:click')
onDocumentClick(): void {
  this.hideContextMenu();
}

@HostListener('document:contextmenu', ['$event'])
onDocumentRightClick(event: MouseEvent): void {
  if ((event.target as HTMLElement).closest('.sidebar')) {
    if (!(event.target as HTMLElement).closest('.file-item')) {
      event.preventDefault();
    }
  }
}
‚ùå REMOVE THESE PROPERTIES:
typescript// ‚ùå REMOVE THESE (around line 120)
contextMenuVisible: boolean = false;
contextMenuX: number = 0;
contextMenuY: number = 0;
contextMenuFileName: string | null = null;

üìù FILE 2: repository-sidebar.component.html
MODIFY: File Item Event Handler (Line ~180)
html<!-- ‚ùå REMOVE THIS LINE -->
(contextmenu)="!item.isFolder && handleFileRightClick($event, item.name)">

<!-- ‚úÖ REPLACE WITH THIS LINE -->
(contextmenu)="!item.isFolder && onFileRightClick($event, item.name)">
MODIFY: Bottom of File (After closing </div> of sidebar)
html<!-- ‚ùå REMOVE THIS ENTIRE SECTION -->
<!-- Context Menu -->
<div class="context-menu" 
     [style.display]="contextMenuVisible ? 'block' : 'none'"
     [style.left.px]="contextMenuX"
     [style.top.px]="contextMenuY">
    <div class="context-menu-item" (click)="summarizeFile()">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
            <polyline points="14 2 14 8 20 8"></polyline>
            <line x1="16" y1="13" x2="8" y2="13"></line>
            <line x1="16" y1="17" x2="8" y2="17"></line>
            <polyline points="10 9 9 9 8 9"></polyline>
        </svg>
        Summarize File
    </div>
</div>

<!-- ‚úÖ ADD THIS LINE AT THE VERY BOTTOM (after </div> of sidebar) -->
<p-contextMenu #cm [model]="contextMenuItems"></p-contextMenu>

üìù FILE 3: repository-sidebar.module.ts
MODIFY: Import Section and NgModule
typescriptimport { NgModule } from '@angular/core';
import { CommonModule } from '@angular/common';
import { FormsModule } from '@angular/forms';
import { RepositorySidebarComponent } from './repository-sidebar.component';

// ‚úÖ ADD THIS IMPORT FOR PRIMENG 16
import { ContextMenuModule } from 'primeng/contextmenu';

@NgModule({
  declarations: [
    RepositorySidebarComponent
  ],
  imports: [
    CommonModule,
    FormsModule,
    ContextMenuModule  // ‚úÖ ADD THIS LINE
  ],
  exports: [
    RepositorySidebarComponent
  ]
})
export class RepositorySidebarModule { }

üìù FILE 4: repository-sidebar.component.css
MODIFY: Bottom of File (Add these styles)
css/* ‚úÖ ADD THESE STYLES AT THE BOTTOM OF THE FILE */

/* ========================================
   PrimeNG 16 Context Menu Theme Overrides
   ======================================== */

/* Main Context Menu Container */
::ng-deep .p-contextmenu {
    background-color: var(--bitbucket-bg-tertiary) !important;
    border: 1px solid var(--bitbucket-border-primary) !important;
    border-radius: 6px !important;
    box-shadow: 0 4px 12px var(--bitbucket-shadow-low) !important;
    padding: 4px 0 !important;
}

/* Menu Items Container */
::ng-deep .p-contextmenu .p-menuitem {
    outline: none !important;
}

/* Menu Item Links */
::ng-deep .p-contextmenu .p-menuitem-link {
    padding: 10px 16px !important;
    color: var(--bitbucket-text-primary) !important;
    transition: background-color 0.2s ease !important;
    border-radius: 0 !important;
    display: flex !important;
    align-items: center !important;
}

/* Menu Item Hover */
::ng-deep .p-contextmenu .p-menuitem-link:not(.p-disabled):hover {
    background-color: var(--bitbucket-border-primary) !important;
}

/* Menu Item Focus */
::ng-deep .p-contextmenu .p-menuitem-link:focus {
    box-shadow: none !important;
    outline: none !important;
}

/* Menu Item Icons */
::ng-deep .p-contextmenu .p-menuitem-icon {
    color: var(--bitbucket-text-secondary) !important;
    font-size: 14px !important;
    margin-right: 10px !important;
}

/* Menu Item Text */
::ng-deep .p-contextmenu .p-menuitem-text {
    color: var(--bitbucket-text-primary) !important;
    font-size: 13px !important;
}

/* Menu Separator */
::ng-deep .p-contextmenu .p-menu-separator {
    border-top: 1px solid var(--bitbucket-border-primary) !important;
    margin: 4px 0 !important;
}

/* Active/Focused Item */
::ng-deep .p-contextmenu .p-menuitem.p-focus > .p-menuitem-link {
    background-color: var(--bitbucket-border-primary) !important;
}

/* Light Mode Adjustments */
[data-theme="light"] ::ng-deep .p-contextmenu {
    background-color: var(--bitbucket-bg-tertiary) !important;
    border-color: var(--bitbucket-border-primary) !important;
    box-shadow: 0 4px 12px var(--bitbucket-shadow-low) !important;
}

[data-theme="light"] ::ng-deep .p-contextmenu .p-menuitem-link:not(.p-disabled):hover {
    background-color: var(--bitbucket-bg-hover) !important;
}

[data-theme="light"] ::ng-deep .p-contextmenu .p-menuitem-icon {
    color: var(--bitbucket-text-secondary) !important;
}

[data-theme="light"] ::ng-deep .p-contextmenu .p-menuitem-text {
    color: var(--bitbucket-text-primary) !important;
}
‚ùå REMOVE THESE CSS RULES:
css/* ‚ùå REMOVE THESE ENTIRE SECTIONS (around line 380-420) */

/* Context Menu */
.context-menu {
    position: fixed;
    background-color: var(--bitbucket-bg-tertiary);
    border: 1px solid var(--bitbucket-border-primary);
    border-radius: 6px;
    padding: 4px 0;
    min-width: 160px;
    box-shadow: 0 4px 12px var(--bitbucket-shadow-low);
    z-index: 1000;
}

.context-menu-item {
    padding: 10px 16px;
    font-size: 13px;
    color: var(--bitbucket-text-primary);
    cursor: pointer;
    transition: background-color 0.2s ease;
    display: flex;
    align-items: center;
    gap: 10px;
}

.context-menu-item:hover {
    background-color: var(--bitbucket-border-primary);
}

.context-menu-item svg {
    width: 16px;
    height: 16px;
    color: var(--bitbucket-text-secondary);
}
